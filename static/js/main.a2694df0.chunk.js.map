{"version":3,"sources":["statics/refer.js","components/Popup/common/styledComponents.js","context/reducer/nodeStatus/actionCreator.js","context/reducer/mindmap/actionCreator.js","context/reducer/nodeStatus/actionTypes.js","context/reducer/history/actionTypes.js","statics/defaultMindmap.js","context/reducer/editPanel/actionTypes.js","context/reducer/history/actionCreator.js","context/reducer/global/actionCreator.js","customHooks/useTheme.js","features/ThemeProvider/index.js","customHooks/useHistory.js","customHooks/useZoom.js","customHooks/useMove.js","components/ToolButton/index.js","components/MindmapTitle/index.js","components/Popup/subComponents/New.js","methods/mindmapParser.js","components/Popup/subComponents/Open.js","components/Popup/subComponents/Theme/ThemeListItem.js","components/Popup/subComponents/Theme/index.js","components/Popup/index.js","components/Popup/common/popupType.js","features/Nav/index.js","methods/getKeydownEvent.js","methods/getMouseWheelEvent.js","context/reducer/editPanel/actionCreator.js","customHooks/useEditPanel.js","components/Node/subComponents/Toolbar.js","components/Node/subComponents/InputDiv.js","components/mdPreview/index.js","components/Node/index.js","components/SubNode/index.js","components/RootNode/index.js","methods/drawCanvas.js","methods/getDragEvents.js","components/DragCanvas/index.js","components/LineCanvas/index.js","features/Mindmap/index.js","components/mdEditor/index.js","features/EditPanel/index.js","features/Main/index.js","App.js","serviceWorker.js","index.js","methods/assistFunctions.js","context/reducer/mindmap/index.js","context/reducer/nodeStatus/index.js","context/reducer/history/index.js","context/reducer/global/index.js","context/reducer/editPanel/index.js","context/index.js","context/reducer/mindmap/actionTypes.js","customHooks/useMindmap.js","context/reducer/global/actionTypes.js"],"names":["LEFT_NODE","RIGHT_NODE","DROP_AREA","ROOT_PARENT","id","children","ROOT_NODE_ID","MINDMAP_ID","MINDMAP_MAIN","NEW_NODE_TEXT","DEFAULT_TITLE","THEME_MAIN","THEME_LIGHT","THEME_DARK","THEME_EX","THEME_ASSIST","ButtonSet","props","className","css","MainButton","refer","Highlight","Annotation","Shortcut","setSelect","node_id","select_by_click","type","actionTypes","data","cur_select","cur_edit","cur_node_info","setEdit","clearAll","getNodeInfo","node","parent","on_left","toggleChildren","bool","showChildren","addChild","new_node_id","text","addSibling","parent_id","moveNode","target_id","is_sibling","changeText","changeInfo","info","deleteNode","expandAll","setMindmap","mindmap","SET_SELECT","SET_EDIT","GET_NODE_INFO","CLEAR_ALL","SET_HISTORY","CLEAR_HISTORY","TOGGLE_PANEL_SHOW","setHistory","cur_node","clearHistory","setTitle","title","useContext","context","global","state","theme_index","theme_list","dispatch","theme","useMemo","setTheme","index","globalAction","ThemeProvider","useTheme","main","light","assist","dark","ex","mDispatch","nDispatch","nodeStatus","history","applySnapshot","snapshot","JSON","parse","undoHistory","undo","length","redoHistory","redo","useZoom","gDispatch","zoomIn","x","y","zoomOut","zoomReset","zoomRate","useMove","moveXY","moveReset","ToolButton","icon","onClick","disabled","handlePropagation","cx","wrapper","disabled_style","MindmapTitle","self","useRef","useEffect","document","localStorage","setItem","ref","contentEditable","suppressContentEditableWarning","spellCheck","onKeyDown","event","key","toUpperCase","current","textContent","blur","onBlur","new_title","trim","slice","New","handleClosePopup","handleDownload","useMindmap","defaultMindmap","getLayerAndText","line","format","layer","match","replace","buildNodeFromJSON","json","copyNodeData","target_node","source_node","is_root_node","expandState","map","child","root","import_data","buildNodeFromText","data_array","cur_layer","cur_text","root_data","shift","md5","Date","now","Math","random","push","split","filter","Open","sub_title","list_wrapper","input","createElement","accept","addEventListener","file","target","files","file_name","name","dot_index","file_reader","FileReader","onload","str","result","mindmapParser","alert","readAsText","click","ThemeListItem","is_current","current_style","style","backgroundColor","Theme","Popup","Content","lazy","getContentComponent","content_wrapper","close_button","fallback","overlay","Nav","useState","popup","setPopup","useHistory","url","encodeURIComponent","stringify","downloadFile","handleZoom","zoom","console","log","handleMove","move","section","mindmapHook","historyHook","editNode","selectNode","navigator","platform","startsWith","metaKey","ctrlKey","shiftKey","preventDefault","trunc","cur_index","findIndex","handleKeyEventWithNode","e","mousemoveInfo","startX","startY","propHook","normalizeXY","wheelDelta","stopPropagation","getWheelDelta","clientX","clientY","buttons","altKey","movedX","movedY","handleWhellEventWithkey","toggelPanelShow","isShow","useEditPanel","editPanel","epState","epDispatch","editPanelAction","savePanel","Toolbar","editPanelHook","InputDiv","focus","getSelection","selectAllChildren","marked","setOptions","renderer","Renderer","highlight","code","hljs","highlightAuto","value","pedantic","gfm","breaks","sanitize","smartLists","smartypants","xhtml","MdPreview","mdtext","querySelectorAll","forEach","block","highlightBlock","fontSize","dangerouslySetInnerHTML","__html","Node","node_refs","add","delete","scrollIntoView","behavior","inline","common_style","specific_style","seleted_style","draggable","data-tag","data-parent","data-show-children","drop_area","onDoubleClick","toggle_button","button_left","button_right","clearNodeStatus","style_selected_border","SubNode","left_style","sub_node","RootNode","root_node","total","half","drawBezier","ctx","from_x","from_y","to_x","to_y","moveTo","bezierCurveTo","drawLineCanvas","beginPath","lineWidth","strokeStyle","drawLine","get","parent_x_left","parent_x_right","parent_y","child_data","child_x_left","child_x_right","child_y","stroke","closePath","drawDragCanvas","child_id","parent_offset","child_offset","child_left_of_parent","setLineDash","parent_x","child_x","top","bottom","left","right","strokeRect","virtual_rect_height","getDomOffset","dom","offsetLeft","offsetWidth","offsetTop","offsetHeight","drag_canvas","container","drag","children_offset_left","children_offset_right","children_offset_vertical","parent_is_root","container_left","container_top","container_width","container_height","in_drop_area","handleContainerScroll","scrollLeft","scrollTop","listener","undefined","dataset","tag","findNode","getElementById","children_offset","each","min","offset","max","reduce","flat_arr","cur","concat","getContext","clearRect","width","height","moveX","moveY","mouse_x","mouse_y","i","last_index","j","parentNode","classList","remove","removeEventListener","DragCanvas","parent_ref","container_ref","flag","setFlag","gState","handleWindowResize","window","handleDrag","getDragEvents","querySelector","LineCanvas","Map","Array","from","Set","Mindmap","hDispatch","zoomHook","moveHook","FLAG","setFLAG","mindmap_json","handleResize","handleKeydown","getKeydownEvent","clientWidth","clientHeight","handleMouseWheel","getMouseWheelEvent","handleMapMove","debounce","MdEditor","propText","setText","textarea","onChange","resize","EditPanel","editPanleHook","show","close","mdEditor","editNodeInfo","position","cursor","Main","App","Boolean","location","hostname","ReactDOM","render","serviceWorker","ready","then","registration","unregister","deepCopy","Object","isArray","output","entries","search_id","find","item","setShowChildrenTrue","filename","link","href","download","func","wait","timer","clearTimeout","setTimeout","apply","arguments","defaultValue_mindmap","getItem","action","new_mindmap","node_found","assign","insert_index","splice","node_index","node_copy","target_index","delete_index","defaultValue_nodeStatus","defaultValue_history","last_snapshot","new_history","unshift","pop","defaultValue_global","Number","newGlobal","obj","defaultValue_editPanel","nodeId","panel","newPanel","React","createContext","WrappedProvider","useReducer","mindmapReducer","mState","nodeStatusReducer","nState","historyReducer","hState","globalReducer","editPanelReducer","combined","Provider","TOGGLE_CHILDREN","ADD_CHILD","ADD_SIBLING","MOVE_NODE","CHANGE_TEXT","DELETE_NODE","EXPAND_ALL","SET_MINDMAP","mindmapAction","nodeStatusAction","is_new_map","SET_TITLE","SET_THEME","ZOOM_IN","ZOOM_OUT","ZOOM_RESET","MOVE_XY","MOVE_RESET","MOVE_XY_WHEN_ZOOM"],"mappings":"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","file":"static/js/main.a2694df0.chunk.js","sourcesContent":["// Node Type\nexport const LEFT_NODE = 'nodeLeft';\nexport const RIGHT_NODE = 'nodeRight';\nexport const DROP_AREA = 'dropArea';\n\n// DOM 操作相关\nexport const ROOT_PARENT = {id: '', children: []};\nexport const ROOT_NODE_ID = 'rmind_root_node';\nexport const MINDMAP_ID = 'rmind_mindmap_wrapper';\nexport const MINDMAP_MAIN = 'rmind_main'\n\n// 缺省文本\nexport const NEW_NODE_TEXT = '新建节点';\nexport const DEFAULT_TITLE = '未命名导图';\n\n// CSS 主题变量名\nexport const THEME_MAIN = '--theme-main';\nexport const THEME_LIGHT = '--theme-light';\nexport const THEME_DARK = '--theme-dark';\nexport const THEME_EX = '--theme-ex';\nexport const THEME_ASSIST = '--theme-assist';","import React from 'react';\nimport {css} from 'emotion';\nimport * as refer from '../../../statics/refer';\n\nexport const ButtonSet = props => (<div {...props} className={css`\ndisplay: flex;\njustify-content: flex-end;\nmargin-top: 20px;\n\nbutton {\nmargin-left: 20px;\npadding: 10px 20px;\nbackground-color: #ffffff;\nborder-radius: 10px;\noutline: none;\n}\n\nbutton:active {\ntransform: scale(0.95);\n}\n`} />);\n\nexport const MainButton = props => (<button {...props} className={css` /* button& 用于提高 CSS 权重 */\nbutton& {\ncolor: #ffffff;\nbackground-color: var(${refer.THEME_DARK});\nborder: 1px solid var(${refer.THEME_MAIN});\n}\n`} />);\n\nexport const Highlight = props => (<p {...props} className={css`\nmargin-top: 0;\ncolor: var(${refer.THEME_ASSIST});\nfont-weight: 700;\n`} />);\n\nexport const Annotation = props => (<p {...props} className={css`\ncolor: #888888;\nfont-size: 90%;\n`} />);\n\nexport const Shortcut = props => (<a {...props} className={css`\ntext-decoration: underline;\ncursor: pointer;\n`} />);","import * as actionTypes from './actionTypes';\n\nexport const setSelect = (node_id, select_by_click) => ({\n    type: actionTypes.SET_SELECT,\n    data: {\n        cur_select: node_id,\n        select_by_click: select_by_click || false,\n        cur_edit: '',\n        cur_node_info: {}\n    }\n});\n\nexport const setEdit = node_id => ({\n    type: actionTypes.SET_EDIT,\n    data: {\n        cur_select: '',\n        cur_edit: node_id,\n        cur_node_info: {}\n    }\n});\n\nexport const clearAll = () => ({\n    type: actionTypes.CLEAR_ALL,\n    data: {\n        cur_select: '',\n        select_by_click: false,\n        cur_edit: '',\n        cur_node_info: {}\n    }\n});\n\nexport const getNodeInfo = (node, parent, on_left) => ({\n    type: actionTypes.GET_NODE_INFO,\n    data: {\n        cur_node_info: {\n            ...node,\n            parent,\n            on_left\n        }\n    }\n});\n","import * as actionTypes from './actionTypes';\nimport {NEW_NODE_TEXT} from '../../../statics/refer';\n\nexport const toggleChildren = (node_id, bool) => ({\n    type: actionTypes.TOGGLE_CHILDREN,\n    data: {\n        node_id,\n        node: {\n            showChildren: bool\n        }\n    }\n});\n\nexport const addChild = (node_id, new_node_id) => ({\n    type: actionTypes.ADD_CHILD,\n    data: {\n        node_id,\n        node: {\n            id: new_node_id,\n            text: NEW_NODE_TEXT,\n            showChildren: true,\n            children: []\n        }\n    }\n});\n\nexport const addSibling = (node_id, parent_id, new_node_id) => ({\n    type: actionTypes.ADD_SIBLING,\n    data: {\n        node_id,\n        parent_id,\n        node: {\n            id: new_node_id,\n            text: NEW_NODE_TEXT,\n            showChildren: true,\n            children: []\n        }\n    }\n});\n\nexport const moveNode = (node_id, target_id, parent_id, is_sibling) => ({\n    type: actionTypes.MOVE_NODE,\n    data: {\n        node_id,\n        target_id,\n        parent_id,\n        is_sibling\n    }\n});\n\nexport const changeText = (node_id, text) => ({\n    type: actionTypes.CHANGE_TEXT,\n    data: {\n        node_id,\n        node: {\n            text\n        }\n    }\n});\n\nexport const changeInfo = (node_id, info) => ({\n    type: actionTypes.CHANGE_TEXT,\n    data: {\n        node_id,\n        node: {\n            info\n        }\n    }\n});\n\nexport const deleteNode = (node_id, parent_id) => ({\n    type: actionTypes.DELETE_NODE,\n    data: {\n        node_id,\n        parent_id\n    }\n});\n\nexport const expandAll = node_id => ({\n    type: actionTypes.EXPAND_ALL,\n    data: {\n        node_id\n    }\n});\n\nexport const setMindmap = mindmap => ({\n    type: actionTypes.SET_MINDMAP,\n    data: {\n        mindmap\n    }\n});\n","export const SET_SELECT = 'nodeStatus/setSelect';\nexport const SET_EDIT = 'nodeStatus/setEdit';\nexport const GET_NODE_INFO = 'nodeStatus/getNodeInfo';\nexport const CLEAR_ALL = 'nodeStatus/clearAll';","export const SET_HISTORY = 'history/setHistory';\nexport const CLEAR_HISTORY = 'history/clearHistory';","import {ROOT_NODE_ID} from './refer';\n\nexport default {\n    id: ROOT_NODE_ID,\n    text: \"主题\",\n    showChildren: true,\n    children: [\n        {\n            id: \"Sub1\",\n            text: \"分支1\",\n            showChildren: true,\n            children: []\n        },\n        {\n            id: \"Sub2\",\n            text: \"分支2\",\n            showChildren: true,\n            children: []\n        },\n        {\n            id: \"Sub3\",\n            text: \"分支3\",\n            showChildren: true,\n            children: []\n        }\n    ]\n}","export const TOGGLE_PANEL_SHOW = 'editPanel/togglePanelShow';","import * as actionTypes from './actionTypes';\n\nexport const setHistory = (mindmap, cur_node) => ({\n    type: actionTypes.SET_HISTORY,\n    data: mindmap ? ({mindmap, cur_node}) : null\n});\n\nexport const clearHistory = () => ({type: actionTypes.CLEAR_HISTORY});","import * as actionTypes from './actionTypes';\n\nexport const setTitle = title => ({\n    type: actionTypes.SET_TITLE,\n    data: {\n        title\n    }\n});\n\nexport const setTheme = theme_index => ({\n    type: actionTypes.SET_THEME,\n    data: {\n        theme_index\n    }\n});\n\n\nexport const zoomIn = (x,y) => ({\n    type: actionTypes.ZOOM_IN,\n    data: {\n        x,y\n    }\n});\n\nexport const zoomOut = (x,y) => ({\n    type: actionTypes.ZOOM_OUT,\n    data: {\n        x,y\n    }\n});\n\nexport const zoomReset = zoomRate => ({\n    type: actionTypes.ZOOM_RESET,\n    data: {\n        zoomRate\n    }\n});\n\nexport const moveReset = () => ({\n    type: actionTypes.MOVE_RESET,\n    data: {\n    }\n});\n\nexport const moveXY = (x,y) => ({\n    type: actionTypes.MOVE_XY,\n    data: {\n        x,y\n    }\n});\n\nexport const moveXYWhenZoom = (x,y) => ({\n    type: actionTypes.MOVE_XY,\n    data: {\n        x,y\n    }\n});\n\n\n","import {useContext, useMemo} from 'react';\nimport {context} from '../context';\nimport * as globalAction from '../context/reducer/global/actionCreator';\n\nexport default () => {\n    const {global: {state: {theme_index, theme_list}, dispatch}} = useContext(context);\n    const theme = useMemo(() => theme_list[theme_index], [theme_index]);\n    const setTheme = index => {\n        dispatch(globalAction.setTheme(index));\n    };\n\n    return {\n        theme,\n        theme_index,\n        theme_list,\n        setTheme\n    }\n}","import React from 'react';\nimport {css} from 'emotion';\nimport useTheme from '../../customHooks/useTheme';\nimport * as refer from '../../statics/refer';\n\nconst ThemeProvider = ({children}) => {\n    const {theme} = useTheme();\n\n    return (<div className={css`\n    ${refer.THEME_MAIN}: ${theme.main};\n    ${refer.THEME_LIGHT}: ${theme.light};\n    ${refer.THEME_ASSIST}: ${theme.assist};\n    ${refer.THEME_DARK}: ${theme.dark};\n    ${refer.THEME_EX}: ${theme.ex};\n    `}>\n        {children}\n    </div>);\n};\n\nexport default ThemeProvider;","import {useContext} from 'react';\nimport {context} from '../context';\nimport {setMindmap} from '../context/reducer/mindmap/actionCreator.js';\nimport {setSelect} from '../context/reducer/nodeStatus/actionCreator.js';\n\nexport default () => {\n    const {mindmap: {dispatch: mDispatch}, nodeStatus: {dispatch: nDispatch}, history: {state: history}} = useContext(context);\n\n    const applySnapshot = snapshot => {\n        if (snapshot) {\n            const {mindmap, cur_node} = snapshot;\n            mDispatch(setMindmap(JSON.parse(mindmap)));\n            nDispatch(setSelect(cur_node));\n        }\n    };\n\n    return {\n        undoHistory: () => {\n            applySnapshot(history.undo[history.undo.length - 1]);\n        },\n        redoHistory: () => {\n            applySnapshot(history.redo[0]);\n        }\n    }\n}\n\n","import {useContext} from 'react';\nimport {context} from '../context';\nimport * as globalAction from '../context/reducer/global/actionCreator';\n\n\nconst useZoom = () => {\n    const {global: {dispatch: gDispatch}} = useContext(context);\n    return {\n        zoomIn: (x,y) => {\n            gDispatch(globalAction.zoomIn(x,y))          \n        },\n        zoomOut: (x,y) => {\n            gDispatch(globalAction.zoomOut(x,y))\n        },\n        zoomReset: () => {\n            gDispatch(globalAction.zoomReset())\n        },\n    }\n};\n\nexport default useZoom;","import {useContext} from 'react';\nimport {context} from '../context';\nimport * as globalAction from '../context/reducer/global/actionCreator';\n\n\nconst useMove = () => {\n    const {global: {dispatch: gDispatch}} = useContext(context);\n    return {        \n        moveXY: (x,y) => {\n            gDispatch(globalAction.moveXY(x,y))\n        },\n        moveReset: () => {\n            gDispatch(globalAction.moveReset())\n        },\n    }\n};\n\nexport default useMove;","import React from 'react';\nimport {css, cx} from 'emotion';\nimport '../../statics/zwicon.css';\nimport * as refer from '../../statics/refer';\nimport {handlePropagation} from '../../methods/assistFunctions'; // 用于禁用按钮点击。如果使用 button 的 disable 属性实现，会由于点击事件冒泡导致 Toolbar 被隐藏\n\nconst ToolButton = ({icon, onClick, children, disabled}) => {\n    return (<button onClick={disabled ? handlePropagation : onClick} className={cx(wrapper, {[disabled_style]: disabled})}>\n            <i className={'zwicon-' + icon} />\n            <span>{children}</span>\n        </button>);\n};\n\nexport default ToolButton;\n\n// CSS\nconst wrapper = css`\nmargin: 0 0.12em;\npadding: 0 0.24em;\n/* margin 用于增加间隔，padding 用于增大可点击区域 */\nbackground-color: transparent;\nborder: none;\noutline: none;\ncursor: pointer;\n\ni {\ndisplay: block;\nmargin-bottom: 0.12em;\nfont-size: 100%;\n}\nspan {\ndisplay: block;\nfont-size: 25%;\n}\n\n&:active {\ntransform: scale(0.95);\n}\n\n&:hover {\ncolor: var(${refer.THEME_ASSIST});\n}\n`;\n\nconst disabled_style = css`\n&, &:hover {\ncolor: #cccccc;\n}\n\ncursor: not-allowed;\n`;","import React, {useEffect, useContext, useRef} from 'react';\nimport {css} from 'emotion';\nimport {context} from '../../context';\nimport {setTitle} from '../../context/reducer/global/actionCreator';\nimport * as refer from '../../statics/refer';\n\nconst MindmapTitle = () => {\n    const self = useRef();\n    const {global: {state: {title}, dispatch}} = useContext(context);\n\n    useEffect(() => {\n        document.title = `RMind - ${title}`;\n        localStorage.setItem('title', title);\n    }, [title]);\n\n    const handleKeydown = event => {\n        switch (event.key.toUpperCase()) {\n            case 'ESCAPE':\n                self.current.textContent = title;\n            case 'ENTER':\n                self.current.blur();\n                break;\n            default:\n                break;\n        }\n    };\n\n    const handleBlur = () => {\n        let new_title = self.current.textContent.trim();\n        if (new_title === '') {\n            new_title = title;\n        }\n        if (new_title.length > 30) {\n            new_title = new_title.slice(0, 30);\n        }\n        self.current.textContent = new_title; // contentEditable 组件内容不会被自动更新\n        dispatch(setTitle(new_title));\n    };\n\n    return (<span ref={self} className={wrapper} contentEditable=\"true\" suppressContentEditableWarning=\"true\"\n                  spellCheck=\"false\"\n                  onKeyDown={handleKeydown} onBlur={handleBlur}>{title}</span>);\n};\n\nexport default MindmapTitle;\n\n// CSS\nconst wrapper = css`\nalign-self: center;\npadding: 0 10px; /* 两侧 padding 用于增大组件点击区域，避免将光标定位至首尾处时意外 blur */\ncolor: var(${refer.THEME_DARK});\nfont-size: 20px;\nfont-weight: 700;\nborder-bottom: 2px solid transparent;\noutline: none;\ntransition: 0.2s;\n\n&:read-write {\ncursor: edit;\n}\n\n&:focus {\nborder-bottom: 2px solid var(${refer.THEME_ASSIST});\n}\n`;","import React, {useContext} from 'react';\nimport {context} from '../../../context';\nimport {setTitle} from '../../../context/reducer/global/actionCreator';\nimport useMindmap from '../../../customHooks/useMindmap';\nimport defaultMindmap from '../../../statics/defaultMindmap';\nimport * as refer from '../../../statics/refer';\nimport {ButtonSet, MainButton, Shortcut, Highlight, Annotation} from '../common/styledComponents';\n\nconst New = ({handleClosePopup, handleDownload}) => {\n    const {global:{dispatch}} = useContext(context);\n    const {setMindmap} = useMindmap();\n\n    const handleNewFile = () => {\n        setMindmap(defaultMindmap, true);\n        dispatch(setTitle(refer.DEFAULT_TITLE));\n        handleClosePopup();\n    };\n\n    return (<div>\n        <Highlight>新建导图后，当前思维导图的数据将丢失。</Highlight>\n        <Annotation>要保存当前数据，请将思维导图<Shortcut onClick={handleDownload}>下载至本地</Shortcut>。</Annotation>\n        <ButtonSet>\n            <MainButton onClick={handleNewFile}>新建导图</MainButton>\n            <button onClick={handleClosePopup}>取消</button>\n        </ButtonSet>\n    </div>);\n};\n\nexport default New;","import md5 from 'md5';\nimport * as refer from '../statics/refer';\n\nconst getLayerAndText = (line, format) => {\n    let layer, text;\n    switch (format) {\n        case 'MD': {\n            if (line.match(/^#{1,6} /)) {\n                layer = line.match(/^#{1,6} /)[0].length - 2;\n                text = line.replace(/^#{1,6} /, '');\n            } else if (line.match(/^\\s*[-*] /)) {\n                layer = line.match(/^\\s*[-*] /)[0].length + 4;\n                text = line.replace(/^\\s*[-*] /, '');\n            }\n            return {layer, text};\n        }\n        case 'TXT': {\n            layer = line.match(/^\\s*/)[0].length;\n            text = line.replace(/^\\s*/, '');\n            return {layer, text};\n        }\n        default:\n            return {layer, text};\n    }\n};\n\nconst buildNodeFromText = (data_array, format, cur_layer, cur_text = '') => {\n    if (data_array.length === 0 && cur_layer === -1) {\n        return;\n    }\n    if (cur_layer === -1) {\n        const root_data = getLayerAndText(data_array.shift(), format);\n        cur_layer = root_data.layer || 0; // 一定的鲁棒性\n        cur_text = root_data.text || '未知数据';\n    }\n    const cur_node = {\n        id: cur_layer === 0 ? refer.ROOT_NODE_ID : md5('' + Date.now() + Math.random() + cur_text),\n        text: cur_text,\n        showChildren: true,\n        children: []\n    };\n    while (data_array.length > 0) {\n        const {layer, text} = getLayerAndText(data_array[0], format);\n        if (layer <= cur_layer) {\n            break;\n        }\n        data_array.shift();\n        if (layer) { // 排除掉无法匹配的情况\n            cur_node.children.push(buildNodeFromText(data_array, format, layer, text));\n        }\n    }\n    return cur_node;\n};\n\nconst copyNodeData = (format, target_node, source_node, is_root_node) => {\n    switch (format) {\n        case 'KM':\n            target_node.id = is_root_node ? refer.ROOT_NODE_ID : source_node.data.id;\n            target_node.text = source_node.data.text;\n            target_node.showChildren = source_node.data.expandState !== 'collapse';\n            target_node.children = source_node.children.map(child => copyNodeData(format, {}, child));\n            return target_node;\n        default:\n            return;\n    }\n};\n\nconst buildNodeFromJSON = (json, format) => {\n    switch (format) {\n        case 'RMF':\n            return JSON.parse(json);\n        case 'KM': {\n            let km_mindmap = JSON.parse(json);\n            return copyNodeData(format, {}, km_mindmap.root, true);\n        }\n        default:\n            return;\n    }\n};\n\nexport default (import_data, format) => {\n    let mindmap;\n    switch (format) {\n        case 'MD':\n        case 'TXT':\n            const data_array = import_data.split('\\n').filter(line => line);\n            mindmap = buildNodeFromText(data_array, format, -1);\n            break;\n        default:\n            mindmap = buildNodeFromJSON(import_data, format);\n            break;\n    }\n    return mindmap;\n}","import React, {useContext} from 'react';\nimport {css} from 'emotion';\nimport {context} from '../../../context';\nimport {setTitle} from '../../../context/reducer/global/actionCreator';\nimport useMindmap from '../../../customHooks/useMindmap';\nimport {ROOT_NODE_ID} from '../../../statics/refer';\nimport mindmapParser from '../../../methods/mindmapParser';\nimport {ButtonSet, MainButton, Shortcut, Highlight, Annotation} from '../common/styledComponents';\n\nconst Open = ({handleClosePopup, handleDownload}) => {\n    const {global: {dispatch}} = useContext(context);\n    const {setMindmap} = useMindmap();\n\n    const handleOpenFile = () => {\n        const input = document.createElement('input');\n        input.type = 'file';\n        input.accept = '.rmf,.km,.txt,.md';\n        input.addEventListener('change', event => {\n            const file = event.target.files[0],\n                file_name = file.name;\n            let dot_index = file_name.length - 1;\n            while (dot_index > 0 && file_name[dot_index] !== '.') {\n                dot_index--;\n            }\n            const format = file_name.slice(dot_index + 1).toUpperCase(),\n                title = file_name.slice(0, dot_index);\n            const file_reader = new FileReader();\n            file_reader.onload = event => {\n                const str = event.target.result;\n                const mindmap = mindmapParser(str, format);\n                if (mindmap && mindmap.id === ROOT_NODE_ID) {\n                    setMindmap(mindmap, true);\n                    dispatch(setTitle(title));\n                    handleClosePopup();\n                } else {\n                    alert('不是有效的思维导图文件');\n                }\n            };\n            file_reader.readAsText(file);\n        });\n        input.click();\n    };\n\n    return (<div>\n        <Highlight>打开其他文件后，当前思维导图的数据将丢失。</Highlight>\n        <Annotation>要保存当前数据，请将思维导图<Shortcut onClick={handleDownload}>下载至本地</Shortcut>。</Annotation>\n        <p className={sub_title}>支持打开格式：</p>\n        <ul className={list_wrapper}>\n            <li>RMind（.rmf）</li>\n            <li>百度脑图（.km）</li>\n            <li>Markdown（.md）</li>\n            <li>文本文件（.txt）</li>\n        </ul>\n        <ButtonSet>\n            <MainButton onClick={handleOpenFile}>打开文件</MainButton>\n            <button onClick={handleClosePopup}>取消</button>\n        </ButtonSet>\n    </div>);\n};\n\nexport default Open;\n\n// CSS\nconst sub_title = css`\nmargin: 20px 0 5px;\npadding-bottom: 8px;\nborder-bottom: 1px solid #dddddd;\n`;\n\nconst list_wrapper = css`\nmargin: 0;\npadding: 0;\nfont-size: 90%;\nlist-style: circle inside;\n\nli {\nline-height: 2em;\n}\n`;","import React from 'react';\nimport {css, cx} from 'emotion';\n\nconst ThemeListItem = ({theme, index, is_current, setTheme}) => {\n    const handleSetTheme = () => {\n        setTheme(index);\n    };\n\n    return (<li className={cx(wrapper, {[current_style]: is_current})} onClick={handleSetTheme}>\n        <div style={{backgroundColor: theme.ex}} />\n        <div style={{backgroundColor: theme.dark}} />\n        <div style={{backgroundColor: theme.main}} />\n        <div style={{backgroundColor: theme.light}} />\n    </li>);\n};\n\nexport default ThemeListItem;\n\n// CSS\n\nconst wrapper = css`\ndisplay: flex;\nbox-sizing: border-box;\nwidth: 47%;\nheight: 25px;\nmargin: 8px 0;\nborder-radius: 18px;\ncursor: pointer;\noverflow: hidden;\n\ndiv {\nflex: 1;\nz-index: -1;\n}\n`;\n\nconst current_style = css`\nbox-shadow: 0 0 0 4px #ffffff, 0 0 0 6px #000000; /* 两层阴影实现框选效果，也可用 inset 阴影 + border-color 做 */\n`;\n","import React, {useEffect} from 'react';\nimport {css} from 'emotion';\nimport useTheme from '../../../../customHooks/useTheme';\nimport {ButtonSet, Highlight} from '../../common/styledComponents';\nimport ThemeListItem from './ThemeListItem';\n\nconst Theme = ({handleClosePopup}) => {\n    const {theme_index, theme_list, setTheme} = useTheme();\n\n    useEffect(() => {\n        localStorage.setItem('theme_index', theme_index);\n    }, [theme_index]);\n\n    return (<div>\n        <Highlight>请选择主题：</Highlight>\n        <ul className={list_wrapper}>\n            {theme_list.map((theme, index) => <ThemeListItem key={theme.main} theme={theme} index={index}\n                                                             is_current={theme_index === index} setTheme={setTheme} />)}\n        </ul>\n        <ButtonSet>\n            <button onClick={handleClosePopup}>完成</button>\n        </ButtonSet>\n    </div>);\n};\n\nexport default Theme;\n\n// CSS\nconst list_wrapper = css`\ndisplay: flex;\njustify-content: space-between;\nflex-wrap: wrap;\npadding: 0;\nlist-style: none;\n`;","import React, {Suspense, lazy} from 'react';\nimport {css} from 'emotion';\nimport * as popupType from './common/popupType';\nimport {handlePropagation} from '../../methods/assistFunctions';\nimport New from './subComponents/New';\nimport Open from './subComponents/Open';\nimport Theme from './subComponents/Theme';\n\nconst getContentComponent = type => {\n    switch (type) {\n        case popupType.NEW:\n            return New;\n        case popupType.OPEN:\n            return Open;\n        case popupType.EXPORT:\n            return lazy(() => import('./subComponents/Export'));\n        case popupType.THEME:\n            return Theme;\n        default:\n            return;\n    }\n};\n\nconst Popup = ({type, handleClosePopup, handleDownload}) => {\n    const Content = getContentComponent(type);\n    return (<div className={wrapper} onClick={handlePropagation}>\n        <div className={content_wrapper}>\n            <i className={'zwicon-close-circle ' + close_button} onClick={handleClosePopup} />\n            <Suspense fallback={<></>}>\n                <Content handleClosePopup={handleClosePopup} handleDownload={handleDownload} />\n            </Suspense>\n        </div>\n        <div className={overlay} onClick={handleClosePopup} />\n    </div>);\n};\n\nexport default Popup;\n\n// CSS\nconst wrapper = css`\nposition: fixed;\ntop:0;\nbottom:0;\nleft:0;\nright:0;\n`;\n\nconst content_wrapper = css`\ndisplay: flex;\nflex-direction: column;\nposition: absolute;\ntop:30%;\nleft:0;\nright:0;\nwidth: 400px;\nmargin: auto;\npadding: 40px 40px 20px;\nfont-size: 1rem;\nbackground-color: #ffffff;\nborder-radius: 20px;\nz-index: 1;\n`;\n\nconst close_button = css`\nposition: absolute;\ntop: 10px;\nright: 10px;\nfont-size: 25px;\nfont-weight: 700;\n\n&:active {\ntransform: scale(0.95)\n}\n`;\n\nconst overlay = css`\nposition: absolute;\ntop:0;\nbottom:0;\nleft:0;\nright:0;\nbackground: #000000;\nopacity: 0.2;\n`;\n","export const NONE = 'none';\nexport const NEW = 'new';\nexport const OPEN = 'open';\nexport const EXPORT = 'export';\nexport const THEME = 'theme';","import React, { useState, useContext } from 'react';\nimport { css } from 'emotion';\nimport { context } from '../../context';\nimport useMindmap from '../../customHooks/useMindmap';\nimport useHistory from '../../customHooks/useHistory';\nimport useZoom from '../../customHooks/useZoom';\nimport useMove from '../../customHooks/useMove';\nimport * as refer from '../../statics/refer';\nimport * as popupType from '../../components/Popup/common/popupType';\nimport { handlePropagation, downloadFile } from '../../methods/assistFunctions'; // 防止 Mindmap 中的选中状态由于冒泡被清除\nimport ToolButton from '../../components/ToolButton';\nimport MindmapTitle from '../../components/MindmapTitle';\nimport Popup from '../../components/Popup';\n\nconst Nav = () => {\n    const [popup, setPopup] = useState(popupType.NONE);\n    const { mindmap: { state: mindmap }, history: { state: history }, global: { state: { title } } } = useContext(context);\n    const { expandAll } = useMindmap();\n    const { zoomIn, zoomOut, zoomReset } = useZoom();\n    const { moveXY, moveReset } = useMove()\n    const { undoHistory, redoHistory } = useHistory();\n\n    const handleClosePopup = () => {\n        setPopup(popupType.NONE);\n    };\n\n    const handleNewFile = () => {\n        setPopup(popupType.NEW);\n    };\n\n    const handleDownload = () => {\n        const url = `data:text/plain,${encodeURIComponent(JSON.stringify(mindmap))}`;\n        downloadFile(url, `${title}.rmf`);\n    };\n\n    const handleOpenFile = () => {\n        setPopup(popupType.OPEN);\n    };\n\n    const handleExport = () => {\n        setPopup(popupType.EXPORT);\n    };\n\n    const handleTheme = () => {\n        setPopup(popupType.THEME);\n    };\n\n    const handleUndo = () => {\n        undoHistory();\n    };\n\n    const handleRedo = () => {\n        redoHistory();\n    };\n\n    const handleExpand = () => {\n        expandAll(refer.ROOT_NODE_ID);\n    };\n\n    const handleZoom = (zoom) => {\n        console.log('缩放', zoom ? zoom : '还原')\n        switch (zoom) {\n            case 'in':\n                zoomIn()\n                break;\n            case 'out':\n                zoomOut()\n                break;\n            default:\n                zoomReset()\n        }\n    }\n\n    const handleMove = (move) => {\n        console.log('移动', move ? move : '还原')\n        switch (move) {\n            case 'up':\n                moveXY(0,-5)\n                break;\n            case 'down':\n                moveXY(0,5)\n                break;\n            case 'left':\n                moveXY(-5,0)\n                break;\n            case 'right':\n                moveXY(5,0)\n                break;\n            default:\n                moveReset()\n        }\n    }\n\n    return (<nav className={wrapper}>\n        <section className={section} onClick={handlePropagation}>\n            <ToolButton icon={'add-item-alt'} onClick={handleNewFile}>新建</ToolButton>\n            <ToolButton icon={'folder-open'} onClick={handleOpenFile}>打开</ToolButton>\n            <ToolButton icon={'file-download'} onClick={handleDownload}>下载至本地</ToolButton>\n            <ToolButton icon={'duplicate'} onClick={handleExport}>导出</ToolButton>\n            <ToolButton icon={'palette'} onClick={handleTheme}>主题</ToolButton>\n            <ToolButton icon={'plus-circle'} onClick={() => handleZoom('in')}>放大</ToolButton>\n            <ToolButton icon={'minus-circle'} onClick={() => handleZoom('out')}>缩小</ToolButton>\n            <ToolButton icon={'rotate-left'} onClick={() => handleZoom()}>还原</ToolButton>\n        </section>\n        <section className={section}>\n            <MindmapTitle />\n        </section>\n        <section className={section} onClick={handlePropagation}>\n            <ToolButton icon={'rotate-left'} onClick={() => handleMove()}>还原</ToolButton>\n            <ToolButton icon={'arrow-left'} onClick={() => handleMove('left')}>左</ToolButton>\n            <ToolButton icon={'arrow-up'} onClick={() => handleMove('up')}>上</ToolButton>\n            <ToolButton icon={'arrow-down'} onClick={() => handleMove('down')}>下</ToolButton>\n            <ToolButton icon={'arrow-right'} onClick={() => handleMove('right')}>右</ToolButton>\n            <ToolButton icon={'undo'} disabled={history.undo.length === 0} onClick={handleUndo}>撤销</ToolButton>\n            <ToolButton icon={'redo'} disabled={history.redo.length === 0} onClick={handleRedo}>重做</ToolButton>\n            <ToolButton icon={'scale'} onClick={handleExpand}>展开所有节点</ToolButton>\n        </section>\n        {popup !== popupType.NONE &&\n            <Popup type={popup} handleClosePopup={handleClosePopup} handleDownload={handleDownload} />}\n    </nav>);\n};\n\nexport default Nav;\n\n// CSS\nconst wrapper = css`\ndisplay: flex;\njustify-content: space-between;\nposition: fixed;\ntop:0;\nleft:0;\nright:0;\nheight: 56px;\npadding: 0 50px;\nfont-size: 25px;\nbackground-color: #ffffff;\nbox-shadow: 0 0px 2px #aaaaaa;\nz-index: 10;\n`;\n\nconst section = css`\ndisplay: flex;\n`;","import * as refer from '../statics/refer';\n\nexport default (nodeStatus, mindmapHook, historyHook) => {\n    const {addChild, addSibling, editNode, deleteNode, toggleChildren, selectNode} = mindmapHook;\n\n    const handleKeyEventWithNode = event => {\n        switch (event.key.toUpperCase()) {\n            case 'TAB':\n                addChild(nodeStatus.cur_select);\n                break;\n            case 'ENTER':\n                event.preventDefault(); // 防止 enter 的点击行为\n                addSibling(nodeStatus.cur_select, nodeStatus.cur_node_info.parent.id);\n                break;\n            case 'F2':\n                editNode(nodeStatus.cur_select);\n                break;\n            case 'BACKSPACE':\n            case 'DELETE':\n                deleteNode(nodeStatus.cur_select, nodeStatus.cur_node_info.parent.id);\n                break;\n            case ' ':\n                event.preventDefault(); // 默认行为会导致画面移动，因此 prevent，下同\n                toggleChildren(nodeStatus.cur_select, !nodeStatus.cur_node_info.showChildren); // Boolean('false') === true\n                break;\n            case 'ARROWLEFT':\n                event.preventDefault();\n                if (nodeStatus.cur_node_info.parent === refer.ROOT_PARENT) {\n                    if (nodeStatus.cur_node_info.children.length > 3) {\n                        selectNode(nodeStatus.cur_node_info.children[Math.trunc(nodeStatus.cur_node_info.children.length / 2)].id);\n                    }\n                } else {\n                    if (!nodeStatus.cur_node_info.on_left) {\n                        selectNode(nodeStatus.cur_node_info.parent.id);\n                    } else if (nodeStatus.cur_node_info.children.length > 0) {\n                        selectNode(nodeStatus.cur_node_info.children[0].id);\n                    }\n                }\n                break;\n            case 'ARROWRIGHT':\n                event.preventDefault();\n                if (nodeStatus.cur_node_info.on_left) {\n                    selectNode(nodeStatus.cur_node_info.parent.id);\n                } else if (nodeStatus.cur_node_info.children.length > 0) {\n                    selectNode(nodeStatus.cur_node_info.children[0].id);\n                }\n                break;\n            case 'ARROWUP': {\n                event.preventDefault();\n                const cur_index = nodeStatus.cur_node_info.parent.children.findIndex(child => child.id === nodeStatus.cur_node_info.id);\n                if (cur_index > 0) {\n                    selectNode(nodeStatus.cur_node_info.parent.children[cur_index - 1].id);\n                }\n                break;\n            }\n            case 'ARROWDOWN': {\n                event.preventDefault();\n                const cur_index = nodeStatus.cur_node_info.parent.children.findIndex(child => child.id === nodeStatus.cur_node_info.id),\n                    last_index = nodeStatus.cur_node_info.parent.children.length - 1;\n                if (cur_index < last_index) {\n                    selectNode(nodeStatus.cur_node_info.parent.children[cur_index + 1].id);\n                }\n                break;\n            }\n            default:\n                break;\n        }\n    };\n\n    return event => {\n        if (nodeStatus.cur_edit === '') {\n            const is_on_mac = navigator.platform.toUpperCase().startsWith('MAC');\n            const combine_key_pressed = is_on_mac ? event.metaKey : event.ctrlKey;\n            if (combine_key_pressed && event.key.toUpperCase() === 'Z') {\n                if (event.shiftKey) {\n                    historyHook.redoHistory();\n                } else {\n                    historyHook.undoHistory();\n                }\n            }\n        }\n        if (nodeStatus.cur_select !== '') {\n            try {\n                handleKeyEventWithNode(event); // 据说在 try 代码块中写大量语句会影响性能，因此包装为函数\n            } catch (e) {\n                alert('当前的节点信息存在问题，请重新选择节点');\n            }\n        }\n    };\n};","const mousemoveInfo = {\n    startX: 0,\n    startY: 0,\n}\n\nexport default (propHook, zoomRate,normalizeXY) => {\n    const { zoomIn, zoomOut, moveXY } = propHook;\n    const getWheelDelta = (e) => {\n        if (e.wheelDelta) {\n            return e.wheelDelta\n        } else {\n            return -e.wheelDelta * 40\n        }\n    }\n\n    const handleWhellEventWithkey = e => {\n\n        if (e.ctrlKey === true && e.wheelDelta) {\n            e.preventDefault()\n            e.stopPropagation()\n            getWheelDelta(e) > 0 ? zoomIn(e.clientX,e.clientY) : zoomOut(e.clientX,e.clientY)\n            return;\n        }\n\n        if (e.buttons === 1 && e.type === 'mousedown') {\n            mousemoveInfo.startX = e.clientX\n            mousemoveInfo.startY = e.clientY\n            return\n        }\n\n        if (e.altKey && e.buttons === 1) {\n            e.stopPropagation()\n            const { startX, startY } = mousemoveInfo;\n            const movedX = (e.clientX - startX);\n            const movedY = (e.clientY - startY);\n            moveXY(movedX / 10 / normalizeXY, movedY / 10)\n            mousemoveInfo.startX = e.clientX\n            mousemoveInfo.startY = e.clientY\n        }\n    };\n\n    return event => {\n        try {\n            handleWhellEventWithkey(event); // 据说在 try 代码块中写大量语句会影响性能，因此包装为函数\n        } catch (e) {\n            alert('移动或缩放功能异常',e);\n        }\n    };\n};","import * as actionTypes from './actionTypes';\n\nexport const toggelPanelShow = (isShow) => ({\n    type: actionTypes.TOGGLE_PANEL_SHOW,\n    data: {\n        isShow,\n    }\n});\n\n\n// export const openPanel = theme_index => ({\n//     type: actionTypes.OPEN_PANEL,    \n// });","import {useContext} from 'react';\nimport {context} from '../context';\nimport * as editPanelAction from '../context/reducer/editPanel/actionCreator';\n\n\nconst useEditPanel = () => {\n    const {editPanel: {state:epState,dispatch: epDispatch}} = useContext(context);\n    return {\n        toggelPanelShow: (bool) => {\n            if(epState.isShow===bool){\n                return ;    \n            }\n            epDispatch(editPanelAction.toggelPanelShow(bool));\n        },\n        savePanel: (bool) => {\n            epDispatch(editPanelAction.toggelPanelShow(bool));\n        },\n    }\n};\n\nexport default useEditPanel;","import React from 'react';\nimport {css} from 'emotion';\nimport useMindmap from '../../../customHooks/useMindmap';\nimport useEditPanel from '../../../customHooks/useEditPanel';\nimport {handlePropagation} from '../../../methods/assistFunctions';\nimport ToolButton from '../../ToolButton';\n\nconst Toolbar = ({layer, node, parent}) => {\n    const mindmapHook = useMindmap();\n    const editPanelHook=useEditPanel();\n\n    const handleAddChild = () => {\n        mindmapHook.addChild(node.id);\n    };\n\n    const handleAddSibling = () => {\n        mindmapHook.addSibling(node.id, parent.id);\n    };\n\n    const handleDeleteNode = () => {\n        mindmapHook.deleteNode(node.id, parent.id);\n    };\n\n    const handleEditNode = () => {\n        mindmapHook.editNode(node.id);\n    };\n\n    const handleToggleChildren = () => {\n        mindmapHook.toggleChildren(node.id, !node.showChildren);\n    };\n\n    const handleAddInfo=()=>{\n        mindmapHook.selectNode(node.id);\n        editPanelHook.toggelPanelShow(true);\n    }\n\n    return (<div className={wrapper} onClick={handlePropagation}>\n        <ToolButton icon={'git-commit'} onClick={handleAddChild}>添加子节点</ToolButton>\n        <ToolButton icon={'git-fork'} onClick={handleAddSibling} disabled={layer < 1}>添加兄弟节点</ToolButton>\n        <ToolButton icon={'delete'} onClick={handleDeleteNode} disabled={layer < 1}>删除</ToolButton>\n        <ToolButton icon={'edit-pencil'} onClick={handleEditNode}>编辑</ToolButton>\n        <ToolButton icon={'edit-pencil'} onClick={handleAddInfo}>添加备注</ToolButton>\n        <ToolButton icon={'split-v'} onClick={handleToggleChildren} disabled={layer < 1 || node.children.length === 0}>显隐子节点</ToolButton>\n    </div>);\n};\n\nexport default Toolbar;\n\n// CSS\nconst wrapper = css`\ndisplay: flex;\nposition: absolute;\nbottom: calc(100% + 5px);\nleft:0;\nbackground-color: #ffffff;\nwidth: max-content;\nheight: 50px;\npadding: 0 8px;\nfont-size: 20px;\nbackground-color: #ffffff;\nborder-radius: 10px;\nbox-shadow: 5px 5px 10px #aaaaaa;\n`;","import React, {useEffect, useRef} from 'react';\nimport {css} from 'emotion';\nimport useMindmap from '../../../customHooks/useMindmap';\nimport {handlePropagation} from '../../../methods/assistFunctions';\n\nconst InputDiv = ({node_id, children}) => {\n    const self = useRef();\n    const {changeText, selectNode} = useMindmap();\n\n    const handleKeydown = event => {\n        switch (event.key.toUpperCase()) {\n            case 'ESCAPE':\n                self.current.textContent = children;\n            case 'ENTER':\n                self.current.blur();\n                break;\n            default:\n                break;\n        }\n    };\n\n    const handleBlur = () => {\n        changeText(node_id, self.current.textContent);\n        selectNode(node_id);\n    };\n\n    useEffect(() => {\n        self.current.focus();\n        const selection = document.getSelection();\n        selection.selectAllChildren(self.current);\n    }, []);\n\n    return (<div className={wrapper} ref={self} contentEditable=\"true\" suppressContentEditableWarning=\"true\"\n                 onClick={handlePropagation} onKeyDown={handleKeydown} onBlur={handleBlur}>{children}</div>);\n};\n\nexport default InputDiv;\n\n// CSS\nconst wrapper = css`\nposition: absolute;\ntop: 0;\nbottom: 0;\nleft: 0;\nright: 0;\nwidth: fit-content;\nmin-width: 1em;\nmax-width: 10em;\nheight: fit-content;\nmargin: auto;\npadding: 10px;\ncolor: #333333;\nbackground-color: #ffffff;\nbox-shadow: 0 0 20px #aaaaaa;\nborder-radius: 5px;\noutline: none;\nz-index: 3;\nuser-select: text;\n`;","import React, { useState, useEffect } from 'react';\nimport marked from 'marked';\nimport './index.css'\n\nimport hljs from 'highlight.js'\nimport 'highlight.js/styles/github.css';\n\nmarked.setOptions({\n    renderer: new marked.Renderer(),\n    highlight: function (code) {\n        return hljs.highlightAuto(code).value;\n    },\n    pedantic: false,\n    gfm: false,\n    breaks: false,\n    sanitize: false,\n    smartLists: true,\n    smartypants: false,\n    xhtml: false\n});\n\nfunction MdPreview(props) {\n    const { mdtext='' } = props;\n\n    //   const [example, setExample] = useState('initialValue');\n    //   useEffect(() => {\n    //     // 使用浏览器的 API 更新页面标题\n    //     // document.title = `You clicked count times`;\n    //   });\n    useEffect(() => {        \n        document.querySelectorAll('pre code').forEach((block) => {\n          hljs.highlightBlock(block);\n        });      \n      },[mdtext]);\n\n    return (\n        <div className=\"MdPreview\">\n            <i className=\"zwicon-note\" style={{ fontSize: 20 }}></i>\n\n            <div className=\"MdPreview-Content\" dangerouslySetInnerHTML={{ __html: marked(mdtext) }} />\n        </div>\n    )\n}\n\nexport default MdPreview;","import React, {useEffect, useRef, useContext} from 'react';\nimport {css, cx} from 'emotion';\nimport {context} from '../../context';\nimport useMindmap from \"../../customHooks/useMindmap\";\nimport {getNodeInfo} from '../../context/reducer/nodeStatus/actionCreator';\nimport * as refer from '../../statics/refer';\nimport {handlePropagation} from '../../methods/assistFunctions';\nimport Toolbar from './subComponents/Toolbar';\nimport InputDiv from './subComponents/InputDiv';\nimport MdPreview from '../mdPreview';\n\nconst Node = ({layer, node, parent, node_refs, on_left}) => {\n    const self = useRef();\n    const {nodeStatus: {state: nodeStatus, dispatch: nDispatch}, editPanel: {state:epState}} = useContext(context);\n    const mindmapHook = useMindmap();\n\n\n    const handleSelectNode = () => {\n        mindmapHook.selectNode(node.id, true);\n    };\n\n    const handleEditNode = () => {\n        mindmapHook.editNode(node.id);\n    };\n\n    const handleToggleChildren = () => {\n        mindmapHook.toggleChildren(node.id, !node.showChildren);\n        mindmapHook.clearNodeStatus(); // 避免出现当前选择的节点被隐藏后仍然可以操作的情况\n    };\n\n    useEffect(() => {\n        node_refs.add(self);\n        return () => {\n            node_refs.delete(self);\n        }\n    }, []);\n\n    useEffect(() => {\n        if (nodeStatus.cur_select === node.id) {\n            self.current.scrollIntoView({behavior: 'smooth', block: 'center', inline: 'center'});\n            nDispatch(getNodeInfo(node, parent, on_left));\n        }\n    }, [nodeStatus.cur_select, node]);    \n\n    // 为避免事件冒泡导致干扰，点击事件放在了 dropArea div，最外层 Node div 用于阻止冒泡\n    return (<div\n        className={cx(common_style, specific_style[layer < 3 ? layer : 3], {[seleted_style]: nodeStatus.cur_select === node.id})}\n        draggable={layer > 0 && nodeStatus.cur_edit !== node.id}\n        data-tag={on_left ? refer.LEFT_NODE : refer.RIGHT_NODE}\n        data-parent={parent.id}\n        data-show-children={node.showChildren}\n        id={node.id}\n        ref={self}\n        onClick={handlePropagation}>\n        {nodeStatus.cur_edit === node.id &&\n        <InputDiv node_id={node.id}>{node.text}</InputDiv>}\n        <div className={drop_area} data-tag={refer.DROP_AREA} onClick={handleSelectNode} onDoubleClick={handleEditNode} />\n        <p>{node.text} {node.info && <MdPreview mdtext={node.info}/>}</p>\n        {(layer > 0 && node.children.length > 0) &&\n        <button className={cx(toggle_button, (on_left ? button_left : button_right))} onClick={handleToggleChildren}>{node.showChildren ? '-' : '+'}</button>}\n        {(nodeStatus.cur_select === node.id && nodeStatus.select_by_click) && !epState.isShow &&\n        <Toolbar layer={layer} node={node} parent={parent} />}\n    </div>);\n};\n\nexport default Node;\n\n// CSS\nconst style_selected_border = `\nbox-shadow: 0 0 0 3px #ffffff, 0 0 0 6px var(${refer.THEME_EX}); /* 双层阴影实现选中框 */\n`;\n\nconst common_style = css`\nposition: relative;\nmin-width: 10px;\nmax-width: 200px;\nmargin: 20px 40px;\npadding: 15px;\nbackground-color: #ffffff;\nborder: 1px solid var(${refer.THEME_MAIN});\nborder-radius: 15px;\ncursor: pointer;\n\np {\nmin-height: 18px; /* 当 p 中没有内容时撑起元素 */\nmargin: 0;\nline-height: 1.5em;\noverflow-wrap: break-word;\n}\n\n&:hover {\n${style_selected_border}\n}\n\n&.ondrag {\nbackground-color: var(${refer.THEME_EX});\np {\ncolor: #ffffff;\n}\n}\n`;\n\nconst specific_style = [ // div&用于提高 CSS 权重\n    css`\ndiv& {\npadding: 15px 20px;\ncolor: #ffffff;\nfont-size: 120%;\nfont-weight: 700;\nbackground-color: var(${refer.THEME_DARK});\nborder:2px solid var(${refer.THEME_EX});\n}\n    `,\n    css`\ndiv& {\nbackground-color: var(${refer.THEME_LIGHT});\n}\n    `,\n    css`\ndiv& {\npadding: 10px 15px;\n}\n    `,\n    css`\ndiv& {\npadding: 0 15px;\nborder: none;\np {\nfont-size: 90%;\n}\n}\n    `\n];\n\nconst seleted_style = css`\nz-index: 1; /* 提高 Node 高度，防止被遮挡 */\n${style_selected_border}\n`;\n\n// 兼有防止文字被选中的功能\nconst drop_area = css`\nposition: absolute;\ntop:0;\nbottom:0;\nleft:0;\nright:0;\n`;\n\nconst toggle_button = css`\nposition: absolute;\ntop:0;\nbottom: 0;\nwidth: 20px;\nheight: 20px;\nmargin: auto 0;\npadding: 0;\ntext-align: center;\nbackground-color: #ffffff;\nborder: 1px solid #cccccc;\nborder-radius: 50%;\noutline: none;\n`;\n\nconst button_left = css`\nleft: -15px;\n`;\n\nconst button_right = css`\nright: -15px;\n`;","import React from 'react';\nimport {css, cx} from 'emotion';\nimport Node from '../Node';\n\nconst SubNode = ({layer, node, node_refs, parent, on_left}) => {\n    return (<div className={cx(wrapper, {[left_style]: on_left})}>\n        <Node layer={layer} node={node} node_refs={node_refs} parent={parent} on_left={on_left} />\n        <div>\n            {node.showChildren && node.children.map(sub_node => <SubNode key={sub_node.id} layer={layer + 1}\n                                                                         node={sub_node} node_refs={node_refs}\n                                                                         parent={node} on_left={on_left} />)}\n        </div>\n    </div>);\n};\n\nexport default SubNode;\n\n// CSS\nconst wrapper = css`\ndisplay: flex;\nalign-items: center;\n`;\n\nconst left_style = css`\nflex-direction: row-reverse;\n`;","import React, {useEffect, useRef} from 'react';\nimport {css} from 'emotion';\nimport {ROOT_PARENT} from '../../statics/refer';\nimport Node from '../Node';\nimport SubNode from '../SubNode';\n\nconst RootNode = ({layer, node, node_refs}) => {\n    const root_node = useRef();\n\n    const total = node.children.length,\n        half = total > 3 ? Math.trunc(total / 2) : total;\n\n    // 载入时使根节点居中。暂时没发现除了多包一层 div 之外更好的解决方法\n    useEffect(() => {\n        root_node.current.scrollIntoView({block: 'center', inline: 'center'});\n    }, []);\n\n    return (<div className={wrapper}>\n        <div>\n            {node.showChildren && node.children.slice(half).map(sub_node => <SubNode\n                key={sub_node.id}\n                layer={layer + 1}\n                node={sub_node}\n                node_refs={node_refs}\n                parent={node} on_left={true} />)}\n        </div>\n        <div ref={root_node}>\n            <Node layer={0} node={node} node_refs={node_refs} parent={ROOT_PARENT} />\n        </div>\n        <div>\n            {node.showChildren && node.children.slice(0, half).map(sub_node => <SubNode\n                key={sub_node.id}\n                layer={layer + 1}\n                node={sub_node}\n                node_refs={node_refs}\n                parent={node}\n                on_left={false} />)}\n        </div>\n    </div>);\n};\n\nexport default RootNode;\n\n// CSS\nconst wrapper = css`\ndisplay: flex;\nalign-items: center;\nwidth: max-content; /* max-content 才能保证正确读取布局 */\n`;","import * as refer from '../statics/refer';\n\nconst drawBezier = (ctx, from_x, from_y, to_x, to_y) => {\n    ctx.moveTo(from_x, from_y);\n    ctx.bezierCurveTo(from_x, to_y, 0.9 * to_x + 0.1 * from_x, to_y, to_x, to_y);\n};\n\nconst drawLine = (ctx, node, map) => {\n    const {id: parent_id, children} = node;\n    if (children.length > 0) {\n        const [parent_x_left, parent_x_right, parent_y] = map.get(parent_id);\n\n        children.forEach(child => {\n            const child_data = map.get(child.id);\n            if (child_data) {\n                const [child_x_left, child_x_right, child_y, child_tag] = child_data;\n                if (child_tag === refer.LEFT_NODE) {\n                    drawBezier(ctx, parent_x_left, parent_y, child_x_right, child_y);\n                } else {\n                    drawBezier(ctx, parent_x_right, parent_y, child_x_left, child_y);\n                }\n                drawLine(ctx, child, map);\n            }\n        })\n    }\n};\n\nexport const drawLineCanvas = (ctx, theme, mindmap, map) => {\n    ctx.beginPath();\n    ctx.lineWidth = '2';\n    ctx.strokeStyle = theme.main;\n    drawLine(ctx, mindmap, map);\n    ctx.stroke();\n    ctx.closePath();\n};\n\nexport const drawDragCanvas = (ctx, theme, child_id, parent_offset, child_offset, child_left_of_parent) => {\n    const virtual_rect_width = 50,\n        virtual_rect_height = 20;\n    ctx.beginPath();\n    ctx.strokeStyle = theme.main;\n    ctx.lineWidth = '2';\n    ctx.setLineDash([5, 5]);\n    let parent_x,\n        parent_y = (parent_offset.top + parent_offset.bottom) / 2,\n        child_x,\n        child_y = (child_offset.top + child_offset.bottom) / 2;\n    if (child_left_of_parent) {\n        parent_x = parent_offset.left;\n        child_x = child_offset.right;\n        ctx.strokeRect(child_x - virtual_rect_width, child_y - virtual_rect_height / 2, virtual_rect_width, virtual_rect_height);\n    } else {\n        parent_x = parent_offset.right;\n        child_x = child_offset.left;\n        ctx.strokeRect(child_x, child_y - virtual_rect_height / 2, virtual_rect_width, virtual_rect_height);\n    }\n    drawBezier(ctx, parent_x, parent_y, child_x, child_y);\n    ctx.stroke();\n    ctx.closePath();\n};","import * as refer from '../statics/refer';\nimport { findNode } from './assistFunctions';\nimport { drawDragCanvas } from './drawCanvas';\n\nconst getDomOffset = dom => {\n    const left = dom.offsetLeft,\n        right = left + dom.offsetWidth,\n        top = dom.offsetTop,\n        bottom = top + dom.offsetHeight;\n    return { left, right, top, bottom };\n};\n\nexport default (mindmap, drag_canvas, container, theme, mindmapHook,zoom,drag) => {\n    const { moveNode } = mindmapHook;\n\n    let node_id, parent_id, target_id, is_sibling,\n        children, children_offset_left, children_offset_right, children_offset_vertical,\n        parent_offset, parent_is_root,\n        container_left, container_top,container_width,container_height,\n        in_drop_area;\n\n    const resetVariables = () => {\n        node_id = '';\n        parent_id = '';\n        target_id = '';\n        is_sibling = false;\n\n        children = [];\n        children_offset_left = [];\n        children_offset_right = [];\n        children_offset_vertical = [];\n\n        parent_offset = undefined;\n        parent_is_root = false;\n\n        container_left = container.scrollLeft;\n        container_top = container.scrollTop - 56;\n        container_width = container.offsetWidth;\n        container_height = container.offsetHeight;\n\n        in_drop_area = false;\n    };\n\n    const handleContainerScroll = (e) => {\n        \n        container_left = container.scrollLeft;\n        container_top = container.scrollTop - 56; // 56 是 container（Main 组件）顶部 margin 值        \n    };\n\n    return [\n        \n        {\n            type: 'dragstart',\n            listener: event => {\n                resetVariables();\n                container.addEventListener('scroll', handleContainerScroll);\n                if (event.target && (event.target.dataset.tag === refer.LEFT_NODE || event.target.dataset.tag === refer.RIGHT_NODE)) {\n                    node_id = event.target.id;\n                    parent_id = event.target.dataset.parent;\n                    const parent = findNode(mindmap, parent_id);\n                    parent_is_root = parent === mindmap;\n                    parent_offset = getDomOffset(document.getElementById(parent_id));\n                    children[0] = parent.children.map(child => child.id);\n                    let children_offset = [];\n                    children_offset[0] = children[0].map(node_id => getDomOffset(document.getElementById(node_id)));\n                    if (parent_is_root && mindmap.children.length > 3) {\n                        const half = Math.trunc(mindmap.children.length / 2);\n                        children = [children[0].slice(0, half), children[0].slice(half)];\n                        children_offset = [children_offset[0].slice(0, half), children_offset[0].slice(half)];\n                    }\n                    children_offset_left = children_offset.map(each => Math.min(...each.map(offset => offset.left)));\n                    children_offset_right = children_offset.map(each => Math.max(...each.map(offset => offset.right)));\n                    children_offset_vertical = children_offset.map(each => each.map(offset => [offset.top, offset.bottom]).reduce((flat_arr, cur) => flat_arr.concat(cur), []));\n                }\n            }\n        },\n        {\n            type: 'drag',\n            listener: event => {\n                const ctx = drag_canvas.getContext('2d');\n                ctx.clearRect(0, 0, drag_canvas.width, drag_canvas.height);\n                const total = children.length;\n                const moveX=-(container_width*drag.x/100)\n                const moveY=-(container_height*drag.y/100)\n                const mouse_x = (event.x + container_left)/zoom+moveX,\n                    mouse_y = (event.y + container_top)/zoom+moveY;\n                for (let i = 0; i < total; i++) {\n                    if (!in_drop_area && mouse_x > children_offset_left[i] && mouse_x < children_offset_right[i]) {\n                        let child_offset = { left: children_offset_left[i], right: children_offset_right[i] };\n                        const child_left_of_parent = i === 1 || (!parent_is_root && (document.getElementById(node_id).dataset.tag === refer.LEFT_NODE)); // i = 1，即出现双侧拖拽时，左侧发生的拖拽 child_left_of_parent 必然为 true\n                        const last_index = children_offset_vertical[i].length - 1;\n                        if (mouse_y > children_offset_vertical[i][0] - 200 && mouse_y < children_offset_vertical[i][0]) { // 优化体验，实际是显示的 2 倍\n                            child_offset.top = children_offset_vertical[i][0] - 50;\n                            child_offset.bottom = children_offset_vertical[i][0];\n                            drawDragCanvas(ctx, theme, node_id, parent_offset, child_offset, child_left_of_parent);\n                            target_id = children[i][0];\n                            is_sibling = true;\n                            return;\n                        }\n                        for (let j = 2; j < last_index + 1; j += 2) {\n                            if (mouse_y > children_offset_vertical[i][j - 1] && mouse_y < children_offset_vertical[i][j]) {\n                                child_offset.top = children_offset_vertical[i][j - 1];\n                                child_offset.bottom = children_offset_vertical[i][j];\n                                drawDragCanvas(ctx, theme, node_id, parent_offset, child_offset, child_left_of_parent);\n                                target_id = children[i][j / 2];\n                                is_sibling = true;\n                                return;\n                            }\n                        }\n                        if (mouse_y > children_offset_vertical[i][last_index] && mouse_y < children_offset_vertical[i][last_index] + 200) {\n                            child_offset.top = children_offset_vertical[i][last_index];\n                            child_offset.bottom = children_offset_vertical[i][last_index] + 50;\n                            drawDragCanvas(ctx, theme, node_id, parent_offset, child_offset, child_left_of_parent);\n                            target_id = children[i + 1] && children[i + 1][0];\n                            is_sibling = true;\n                            return;\n                        }\n                    }\n                }\n            }\n        },\n        {\n            type: 'dragover',\n            listener: event => {\n                event.preventDefault();\n            }\n        },\n        {\n            type: 'dragenter',\n            listener: event => {\n                if (event.target && event.target.dataset.tag === refer.DROP_AREA) {\n                    event.target.parentNode.classList.add('ondrag');\n                    target_id = event.target.parentNode.id;\n                    is_sibling = false;\n                    in_drop_area = true;\n                }\n            }\n        },\n        {\n            type: 'dragleave',\n            listener: event => {\n                if (event.target && event.target.dataset.tag === refer.DROP_AREA) {\n                    event.target.parentNode.classList.remove('ondrag');\n                    target_id = '';\n                    is_sibling = false;\n                    in_drop_area = false;\n                }\n            }\n        },\n        {\n            type: 'drop',\n            listener: event => {\n                event.target.parentNode.classList.remove('ondrag');\n                if (target_id !== '' && target_id !== node_id && target_id !== parent_id) {\n                    moveNode(node_id, target_id, parent_id, is_sibling);\n                }\n            }\n        },\n        {\n            type: 'dragend',\n            listener: () => {\n                const ctx = drag_canvas.getContext('2d');\n                ctx.clearRect(0, 0, drag_canvas.width, drag_canvas.height);\n                container.removeEventListener('scroll', handleContainerScroll);\n            }\n        }\n    ];\n}","import React, { useState, useEffect, useRef, useContext } from 'react';\nimport { css } from 'emotion';\nimport useMindmap from '../../customHooks/useMindmap';\nimport useTheme from '../../customHooks/useTheme';\nimport getDragEvents from '../../methods/getDragEvents';\nimport { context } from '../../context'\nimport * as refer from '../../statics/refer';\n\nconst DragCanvas = ({ parent_ref, container_ref, mindmap }) => {\n    const self = useRef();\n    const [flag, setFlag] = useState(0);\n\n    const { theme } = useTheme();\n\n    const mindmapHook = useMindmap();\n\n    const { global: { state: gState } } = useContext(context);\n    const {zoom,x,y}=gState\n\n    const handleWindowResize = () => {\n        setFlag(Date.now());\n    };\n\n    useEffect(() => {\n        window.addEventListener('resize', handleWindowResize);\n        return () => {\n            window.removeEventListener('resize', handleWindowResize);\n        }\n    }, []);\n\n    useEffect(() => {\n        const handleDrag = getDragEvents(mindmap, self.current, container_ref.current, theme, mindmapHook,zoom,{x,y});\n        handleDrag.forEach(event => document.querySelector(`#${refer.MINDMAP_ID}`).addEventListener(event.type, event.listener));\n        return () => {\n            handleDrag.forEach(event => document.querySelector(`#${refer.MINDMAP_ID}`).removeEventListener(event.type, event.listener));\n        }\n    }, [mindmap, theme,zoom,x,y]);\n\n    useEffect(() => {\n        const dom = self.current;\n        dom.width = parent_ref.current.offsetWidth;\n        dom.height = parent_ref.current.offsetHeight;\n    }, [mindmap, flag, gState.zoom]);\n\n    return (<canvas ref={self} className={wrapper} />);\n};\n\nexport default DragCanvas;\n\n// CSS\nconst wrapper = css`\nposition: absolute;\ntop:0;\nleft:0;\nz-index: -1;\n`;","import React, {useState, useEffect, useRef, useContext} from 'react';\nimport {css} from 'emotion';\nimport useTheme from '../../customHooks/useTheme';\nimport {context} from '../../context'\nimport {drawLineCanvas} from '../../methods/drawCanvas';\n\nconst LineCanvas = ({parent_ref, mindmap, node_refs}) => {\n    const self = useRef();\n    const [flag, setFlag] = useState(0);\n\n    const {theme} = useTheme();\n    const {global:{state:gState}}=useContext(context);\n\n    const handleWindowResize = (e) => {\n        setFlag(Date.now());        \n    };\n\n    useEffect(() => {\n        window.addEventListener('resize', handleWindowResize);\n        return () => {\n            window.removeEventListener('resize', handleWindowResize);\n        }\n    }, []);\n\n    useEffect(() => {\n        const dom = self.current;\n        dom.width = parent_ref.current.offsetWidth;\n        dom.height = parent_ref.current.offsetHeight; // 重新设置 canvas 大小，也兼具清除画板的作用\n        const map = new Map(Array.from(node_refs).map(ref => [ref.current.id, [(ref.current.offsetLeft), (ref.current.offsetLeft + ref.current.offsetWidth), (ref.current.offsetTop + 0.5 * ref.current.offsetHeight), ref.current.dataset.tag]]));\n        const ctx = dom.getContext('2d');\n        drawLineCanvas(ctx, theme, mindmap, map);\n    }, [mindmap, theme, flag, gState.zoom]);\n\n    return (<canvas ref={self} className={wrapper} />);\n};\n\nexport default LineCanvas;\n\n// CSS\nconst wrapper = css`\nposition: absolute;\ntop:0;\nleft:0;\nz-index: -2;\n`;","import React, { useEffect, useContext, useRef, useMemo, useState } from 'react';\nimport { css } from 'emotion';\nimport * as refer from '../../statics/refer';\nimport { context } from '../../context/';\nimport { setHistory } from '../../context/reducer/history/actionCreator';\nimport useMindmap from '../../customHooks/useMindmap';\nimport useHistory from '../../customHooks/useHistory';\nimport getKeydownEvent from '../../methods/getKeydownEvent';\nimport getMouseWheelEvent from '../../methods/getMouseWheelEvent';\nimport RootNode from '../../components/RootNode';\nimport DragCanvas from '../../components/DragCanvas';\nimport LineCanvas from '../../components/LineCanvas';\nimport useZoom from '../../customHooks/useZoom';\nimport useMove from '../../customHooks/useMove';\nimport { debounce } from '../../methods/assistFunctions';\n\nconst node_refs = new Set();\n\nconst Mindmap = ({ container_ref }) => {\n    const self = useRef();\n    const { mindmap: { state: root_node }, nodeStatus: { state: nodeStatus }, history: { dispatch: hDispatch }, global: { state: gState } } = useContext(context);\n\n    const historyHook = useHistory();\n    const mindmapHook = useMindmap();\n    const zoomHook = useZoom();\n    const moveHook = useMove()\n    const { clearNodeStatus } = mindmapHook;\n    const [FLAG, setFLAG] = useState(0)\n\n    const mindmap_json = useMemo(() => JSON.stringify(root_node), [root_node]); // 如果 root_node 没有 JSON.stringify，使用按键操作时有时会连续两次触发 useEffect，目前没查出来为什么。利用 useMemo 避免重复触发\n\n    const handleResize = () => {\n        setFLAG(Date.now())\n    }\n\n    useEffect(() => {\n        const handleKeydown = getKeydownEvent(nodeStatus, mindmapHook, historyHook);\n        window.addEventListener('keydown', handleKeydown);\n        return () => {\n            window.removeEventListener('keydown', handleKeydown);\n        }\n    }, [nodeStatus]);\n\n    useEffect(() => {\n        window.addEventListener('click', clearNodeStatus);\n        return () => {\n            window.removeEventListener('click', clearNodeStatus);\n        }\n    }, []);\n\n    useEffect(() => {\n        window.addEventListener('resize', handleResize);\n        return () => {\n            window.removeEventListener('resize', handleResize);\n        }\n    }, [])\n\n    useEffect(() => {\n        const normalizeXY = container_ref.current.clientWidth / container_ref.current.clientHeight\n        const handleMouseWheel = getMouseWheelEvent(zoomHook, gState.zoom)\n        const handleMapMove = getMouseWheelEvent(moveHook, gState.zoom, normalizeXY)\n        document.querySelector(`#${refer.MINDMAP_MAIN}`).addEventListener('wheel', handleMouseWheel);\n        document.querySelector(`#${refer.MINDMAP_MAIN}`).addEventListener('mousemove', debounce(handleMapMove, 4));\n        document.querySelector(`#${refer.MINDMAP_MAIN}`).addEventListener('mousedown', handleMapMove)\n        return () => {\n            document.querySelector(`#${refer.MINDMAP_MAIN}`).removeEventListener('wheel', handleMouseWheel);\n            document.querySelector(`#${refer.MINDMAP_MAIN}`).addEventListener('mousemove', debounce(handleMapMove, 4));\n            document.querySelector(`#${refer.MINDMAP_MAIN}`).addEventListener('mousedown', handleMapMove);\n        }\n    }, [FLAG]);\n\n    useEffect(() => {\n        localStorage.setItem('mindmap', mindmap_json);\n        hDispatch(setHistory(mindmap_json, nodeStatus.cur_select || nodeStatus.cur_edit));\n    }, [mindmap_json]);\n\n    return (\n        <div\n            className={wrapper}\n            ref={self}\n            style={{ zoom: gState.zoom, left: gState.x + 'vw', top: gState.y + 'vh' }}\n            id={refer.MINDMAP_ID}\n            draggable={false}>\n            <RootNode key={root_node.id} layer={0} node={root_node} node_refs={node_refs} />\n            <DragCanvas parent_ref={self} container_ref={container_ref} mindmap={root_node} />\n            <LineCanvas parent_ref={self} mindmap={root_node} node_refs={node_refs} />\n        </div>\n    );\n};\n\nexport default Mindmap;\n\n// CSS\nconst wrapper = css`\nposition: relative;\nwidth: fit-content;\npadding: 30vh 30vw;\n`;","import React, { useState, useEffect } from 'react';\n\nfunction MdEditor(props) {\n    const { propText } = props;\n\n    const [text, setText] = useState(propText);\n\n    useEffect(() => {\n        setText(propText)\n    }, [propText]);\n    \n    const onChange = (e) => {\n        setText(e.target.value)\n    }\n\n    const onBlur = () => {\n        console.log('备注：', text)\n        props.onBlur && props.onBlur(text)\n    }\n\n\n\n    return (\n        <div className={props.className || ''}>\n            <textarea style={textarea} onChange={onChange} onBlur={onBlur} value={text} />\n        </div>\n    )\n}\n\nexport default MdEditor;\n\n\nconst textarea = {\n    width: '100%',\n    height: '100%',\n    resize: 'none'\n}","import React, {useContext, useEffect} from 'react';\nimport {css} from 'emotion';\nimport useEditPanel from '../../customHooks/useEditPanel';\nimport useMindmap from '../../customHooks/useMindmap';\nimport {context} from '../../context'\nimport MdEditor from '../../components/mdEditor';\n\nconst EditPanel = () => {\n    // const self = useRef();\n    \n    const {editPanel: {state:epState},nodeStatus:{state:nState}} =useContext(context)\n    const {cur_node_info:{info='',text,id}}=nState\n    \n    const mindmapHook=useMindmap()\n    const editPanleHook=useEditPanel();\n    \n    if(!epState.isShow){\n        return null;\n    }\n    \n    return (        \n        <div className={show} onClick={e=>e.stopPropagation()} onKeyDown={e=>e.stopPropagation()}>\n            当前编辑节点：{text || '无'}        \n\n            <i className=\"zwicon-close\" style={close} onClick={()=>editPanleHook.toggelPanelShow(false)}></i>                        \n            <MdEditor \n                className={mdEditor} \n                propText={info}\n                onBlur={(value)=> id && mindmapHook.editNodeInfo(id,value)}\n            />                       \n            {/* <Button type=\"primary\" onClick={()=>mindmapHook.editNodeInfo(id,inputVal)}>保存</Button>\n            <Button type=\"primary\" onClick={()=>editPanleHook.toggelPanelShow(false)}>关闭</Button> */}            \n        </div>\n    );\n};\n\nexport default EditPanel;\n\n// CSS\nconst show = css`\nheight: 500px;\nwidth: 300px;\ntop: 20px;\nright: 40px;\nmargin: 56px 0 0;\noverflow: auto;\nposition: fixed;\n//z-index: 10;\nborder: 2px solid #eeee;\nborder-radius: 10px;\nbackground: #fff;\nbackground:rgba(255,255,255,1);\nbox-shadow:0px 2px 12px 0px rgba(0,0,0,0.16);\npadding:20px 10px;\n`;\n\nconst close={    \n    fontSize:20,\n    position: 'absolute',\n    cursor:'pointer',\n    right: '10px',\n    top: '5px',\n}\n\nconst mdEditor=css`\n    margin-top:20px;\n    width:295px;\n    height:460px;\n`","import React, { useRef } from 'react';\nimport { css } from 'emotion';\nimport Mindmap from '../Mindmap';\nimport EditPanel from '../EditPanel';\nimport * as refer from '../../statics/refer';\n\nconst Main = () => {\n    const self = useRef();\n\n    return (<main ref={self} className={wrapper} id={refer.MINDMAP_MAIN}>\n        <Mindmap container_ref={self} />\n        <EditPanel />\n    </main>);\n};\n\nexport default Main;\n\n// CSS\nconst wrapper = css`\nheight: calc(100vh - 56px);\nmargin: 56px 0 0;\noverflow: hidden;\n`;","import React from 'react';\nimport Provider from './context/';\nimport ThemeProvider from './features/ThemeProvider'\nimport Nav from './features/Nav';\nimport Main from './features/Main'\n\nconst App = () => {\n    return (<Provider>\n        <ThemeProvider>\n            <Nav />\n            <Main />\n        </ThemeProvider>\n    </Provider>);\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'normalize.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","export const handlePropagation = event => {\n    event.stopPropagation();\n};\n\nexport const deepCopy = input => { // 简单的递归深拷贝，只考虑 context 中 state 的复制，因此没有处理 function 等\n    if (input instanceof Object) {\n        if (Array.isArray(input)) {\n            return input.map(deepCopy);\n        }\n        let output = {};\n        Object.entries(input).forEach(([key, value]) => {\n            output[key] = deepCopy(value);\n        });\n        return output;\n    }\n    return input;\n};\n\nexport const findNode = (node, search_id) => {\n    if (node.id === search_id) {\n        return node;\n    }\n    return node.children.map(child => findNode(child, search_id)).find(item => item);\n};\n\nexport const setShowChildrenTrue = node => {\n    node.showChildren = true;\n    node.children.forEach(setShowChildrenTrue);\n};\n\nexport const downloadFile = (url, filename) => {\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = filename;\n    link.click();\n};\n\nexport const debounce=(func,wait)=>{\n    let timer=null;\n    return function(){\n      if(timer) clearTimeout(timer);\n      timer=setTimeout(()=>{\n        // 绑定this的目的是，使得func的this指针保持普通,调用时候的指向\n        // argument也为调用debounce过后的func传入的参数\n        func.apply(this,arguments);\n      },wait)\n    }\n  \n  }","import * as actionTypes from './actionTypes';\nimport defaultMindmap from '../../../statics/defaultMindmap';\nimport {findNode, deepCopy, setShowChildrenTrue} from '../../../methods/assistFunctions';\n\nexport const defaultValue_mindmap = JSON.parse(localStorage.getItem('mindmap')) || defaultMindmap;\n\nexport default (mindmap, action) => {\n    switch (action.type) {\n        case actionTypes.TOGGLE_CHILDREN: {\n            const new_mindmap = deepCopy(mindmap),\n                node_found = findNode(new_mindmap, action.data.node_id);\n            if (node_found.children.length > 0 && node_found !== new_mindmap) {\n                Object.assign(node_found, action.data.node);\n            }\n            return new_mindmap;\n        }\n        case actionTypes.ADD_CHILD: {\n            const new_mindmap = deepCopy(mindmap),\n                node_found = findNode(new_mindmap, action.data.node_id);\n            node_found.children.push(action.data.node);\n            return new_mindmap;\n        }\n        case actionTypes.ADD_SIBLING: {\n            const new_mindmap = deepCopy(mindmap);\n            if (action.data.parent_id) {\n                const node_found = findNode(new_mindmap, action.data.parent_id);\n                const insert_index = node_found.children.findIndex(node => node.id === action.data.node_id) + 1;\n                node_found.children.splice(insert_index, 0, action.data.node);\n            }\n            return new_mindmap;\n        }\n        case actionTypes.MOVE_NODE: {\n            const new_mindmap = deepCopy(mindmap),\n                parent = findNode(new_mindmap, action.data.parent_id),\n                node_index = parent.children.findIndex(node => node.id === action.data.node_id),\n                node_copy = parent.children[node_index];\n            parent.children.splice(node_index, 1);\n            if (action.data.is_sibling) {\n                const target_index = parent.children.findIndex(node => node.id === action.data.target_id) + 1 || parent.children.length + 1;\n                parent.children.splice(target_index - 1, 0, node_copy);\n            } else {\n                const target_node = findNode(new_mindmap, action.data.target_id);\n                target_node.children.push(node_copy);\n            }\n            return new_mindmap;\n        }\n        case actionTypes.CHANGE_TEXT: {\n            const new_mindmap = deepCopy(mindmap),\n                node_found = findNode(new_mindmap, action.data.node_id);\n            Object.assign(node_found, action.data.node);\n            return new_mindmap;\n        }\n        case actionTypes.DELETE_NODE: {\n            const new_mindmap = deepCopy(mindmap);\n            if (action.data.parent_id) {\n                const node_found = findNode(new_mindmap, action.data.parent_id);\n                const delete_index = node_found.children.findIndex(node => node.id === action.data.node_id);\n                node_found.children.splice(delete_index, 1);\n            }\n            return new_mindmap;\n        }\n        case actionTypes.EXPAND_ALL: {\n            const new_mindmap = deepCopy(mindmap);\n            const node_found = findNode(new_mindmap, action.data.node_id);\n            setShowChildrenTrue(node_found);\n            return new_mindmap;\n        }\n        case actionTypes.SET_MINDMAP: {\n            return action.data.mindmap;\n        }\n        default:\n            return mindmap;\n    }\n};","import * as actionTypes from './actionTypes';\n\nexport const defaultValue_nodeStatus = {\n    cur_select: '',\n    select_by_click: false,\n    cur_edit: '',\n    cur_node_info: {}\n};\n\nexport default (nodeStatus, action) => {\n    switch (action.type) {\n        case actionTypes.SET_SELECT:\n            if (nodeStatus.cur_select === action.data.cur_select) { // 避免 cur_select 未变更时 info 被清空\n                delete action.data.cur_node_info;\n            }\n            return {...nodeStatus, ...action.data};\n        case actionTypes.SET_EDIT:\n        case actionTypes.CLEAR_ALL:\n        case actionTypes.GET_NODE_INFO:\n            return {...nodeStatus, ...action.data};\n        default:\n            return nodeStatus;\n    }\n};","import * as actionTypes from './actionTypes';\nimport {deepCopy} from '../../../methods/assistFunctions';\n\nexport const defaultValue_history = {\n    undo: [],\n    redo: [],\n    last_snapshot: null\n};\n\nexport default (history, action) => {\n    switch (action.type) {\n        case actionTypes.SET_HISTORY: {\n            const new_history = deepCopy(history);\n            if (new_history.last_snapshot) {\n                if (new_history.undo.length > 0 && new_history.undo[new_history.undo.length - 1].mindmap === action.data.mindmap) {\n                    new_history.redo.unshift(new_history.last_snapshot);\n                    new_history.undo.pop();\n                } else if (new_history.redo.length > 0 && new_history.redo[0].mindmap === action.data.mindmap) {\n                    new_history.undo.push(new_history.last_snapshot);\n                    new_history.redo.shift();\n                } else {\n                    new_history.undo.push(new_history.last_snapshot);\n                    new_history.redo = [];\n                }\n            }\n            new_history.last_snapshot = action.data;\n            return new_history;\n        }\n        case actionTypes.CLEAR_HISTORY: {\n            return defaultValue_history;\n        }\n        default:\n            return history;\n    }\n};","import * as actionTypes from './actionTypes';\nimport * as refer from '../../../statics/refer';\nimport { deepCopy } from '../../../methods/assistFunctions';\nimport { debug } from 'util';\n\nexport const defaultValue_global = {\n    title: localStorage.getItem('title') || refer.DEFAULT_TITLE,\n    theme_index: Number(localStorage.getItem('theme_index')) || 0,\n    theme_list: [\n        { main: \"#eda938\", light: \"#f4cc87\", dark: \"#e79021\", ex: \"#ce7529\", assist: \"#1980da\" },\n        { main: \"#ff4c26\", light: \"#ffcabc\", dark: \"#e83f1d\", ex: \"#c12a0f\", assist: \"#0e95ac\" },\n        { main: \"#50b843\", light: \"#c3e5bd\", dark: \"#28ab17\", ex: \"#038b00\", assist: \"#790595\" },\n        { main: \"#2d99d7\", light: \"#e2f5ff\", dark: \"#2786c3\", ex: \"#2375af\", assist: \"#ca6c27\" },\n        { main: \"#b347d2\", light: \"#e4c0ef\", dark: \"#a623c9\", ex: \"#9621c3\", assist: \"#009000\" },\n        { main: \"#555555\", light: \"#e9e9e9\", dark: \"#434343\", ex: \"#262626\", assist: \"#860314\" }\n    ],\n    zoom: 1,\n    x:0,\n    y:0,\n};\n\nconst ZOOM_STEP=0.1;\nconst MOVE_STEP=0.1;\n\nconst preventMinValue=(obj,key,min)=>{\n    \n    if(obj[key]<=min){\n        obj[key]=min\n    }\n}\n\nexport default (global, action) => {\n    switch (action.type) {\n        case actionTypes.SET_TITLE:\n        case actionTypes.SET_THEME:\n            return Object.assign(deepCopy(global), action.data);\n        case actionTypes.ZOOM_IN: {\n            const newGlobal = deepCopy(global)\n            newGlobal.zoom += ZOOM_STEP;\n            return newGlobal;\n        }\n        case actionTypes.ZOOM_OUT: {\n            const newGlobal = deepCopy(global)\n            newGlobal.zoom -= ZOOM_STEP;\n            preventMinValue(newGlobal,'zoom', 0.3)\n            return newGlobal;\n        }\n        case actionTypes.ZOOM_RESET: {\n            const newGlobal = deepCopy(global)\n            newGlobal.zoom = 1;\n            return newGlobal;\n        }        \n        case actionTypes.MOVE_XY: {\n            const newGlobal = deepCopy(global)\n            newGlobal.x+=action.data.x/newGlobal.zoom;\n            newGlobal.y+=action.data.y/newGlobal.zoom;\n            return newGlobal;\n        }        \n        case actionTypes.MOVE_RESET: {\n            const newGlobal = deepCopy(global)\n            newGlobal.x=0;\n            newGlobal.y=0;\n            return newGlobal;\n        }\n        case actionTypes.MOVE_XY_WHEN_ZOOM:{\n            const newGlobal = deepCopy(global)\n            newGlobal.x=0;\n            newGlobal.x=0;\n            return newGlobal;\n        }\n        default:\n            return global;\n    }\n};","import * as actionTypes from './actionTypes';\n// import defaultMindmap from '../../../statics/defaultMindmap';\nimport {deepCopy} from '../../../methods/assistFunctions';\n\nexport const defaultValue_editPanel = {\n    isShow:false,\n    nodeId:''\n};\n\nexport default (panel, action) => {\n    switch (action.type) {        \n        case actionTypes.TOGGLE_PANEL_SHOW: \n            const newPanel = deepCopy(panel);\n            newPanel.isShow=action.data.isShow\n            return newPanel        \n        default:\n            return panel;\n    }\n};","import React, {useReducer} from 'react';\nimport mindmapReducer, {defaultValue_mindmap} from './reducer/mindmap/';\nimport nodeStatusReducer, {defaultValue_nodeStatus} from './reducer/nodeStatus';\nimport historyReducer, {defaultValue_history} from './reducer/history';\nimport globalReducer, {defaultValue_global} from './reducer/global';\nimport editPanelReducer,{defaultValue_editPanel} from './reducer/editPanel';\n\nconst context = React.createContext({});\n\nconst WrappedProvider = props => {\n    const [mState, mDispatch] = useReducer(mindmapReducer, defaultValue_mindmap);\n    const [nState, nDispatch] = useReducer(nodeStatusReducer, defaultValue_nodeStatus);\n    const [hState, hDispatch] = useReducer(historyReducer, defaultValue_history);\n    const [gState, gDispatch] = useReducer(globalReducer, defaultValue_global);\n    const [epState, epDispatch] = useReducer(editPanelReducer, defaultValue_editPanel);\n    const combined = {\n        mindmap: {\n            state: mState,\n            dispatch: mDispatch\n        },\n        nodeStatus: {\n            state: nState,\n            dispatch: nDispatch\n        },\n        history: {\n            state: hState,\n            dispatch: hDispatch\n        },\n        global: {\n            state: gState,\n            dispatch: gDispatch\n        },\n        editPanel: {\n            state: epState,\n            dispatch: epDispatch\n        }\n    };\n\n    return (<context.Provider value={combined}>\n        {props.children}\n    </context.Provider>)\n};\n\nexport {context};\nexport default WrappedProvider;","export const TOGGLE_CHILDREN = 'mindmap/toggleChildren';\nexport const ADD_CHILD = 'mindmap/addChild';\nexport const ADD_SIBLING = 'mindmap/addSibling';\nexport const MOVE_NODE = 'mindmap/moveNode';\nexport const CHANGE_TEXT = 'mindmap/changeText';\nexport const DELETE_NODE = 'mindmap/deleteNode';\nexport const EXPAND_ALL = 'mindmap/expandAll';\nexport const SET_MINDMAP = 'mindmap/setMindmap';","import {useContext} from 'react';\nimport {context} from '../context';\nimport * as mindmapAction from '../context/reducer/mindmap/actionCreator';\nimport * as nodeStatusAction from '../context/reducer/nodeStatus/actionCreator.js';\nimport {clearHistory} from '../context/reducer/history/actionCreator';\nimport md5 from 'md5';\n\nconst useMindmap = () => {\n    const {mindmap: {dispatch: mDispatch}, nodeStatus: {dispatch: nDispatch}, history: {dispatch: hDispatch}} = useContext(context);\n    return {\n        toggleChildren: (node_id, bool) => {\n            mDispatch(mindmapAction.toggleChildren(node_id, bool));\n        },\n        addChild: node_id => {\n            const new_node_id = md5('' + Date.now() + Math.random());\n            mDispatch(mindmapAction.toggleChildren(node_id, true));\n            mDispatch(mindmapAction.addChild(node_id, new_node_id));\n            nDispatch(nodeStatusAction.setEdit(new_node_id));\n        },\n        addSibling: (node_id, parent_id) => {\n            const new_node_id = md5('' + Date.now() + Math.random());\n            mDispatch(mindmapAction.addSibling(node_id, parent_id, new_node_id));\n            nDispatch(nodeStatusAction.setEdit(new_node_id));\n        },\n        moveNode: (node_id, target_id, parent_id, is_sibling) => {\n            mDispatch(mindmapAction.moveNode(node_id, target_id, parent_id, is_sibling));\n            nDispatch(nodeStatusAction.setSelect(node_id));\n        },\n        editNode: node_id => {\n            nDispatch(nodeStatusAction.setEdit(node_id));\n        },\n        changeText: (node_id, text) => {\n            mDispatch(mindmapAction.changeText(node_id, text));\n        },\n        editNodeInfo:(node_id,info)=>{\n            mDispatch(mindmapAction.changeInfo(node_id, info));                      \n          },\n        selectNode: (node_id, select_by_click) => {\n            nDispatch(nodeStatusAction.setSelect(node_id, select_by_click));\n        },\n        deleteNode: (node_id, parent_id) => {\n            mDispatch(mindmapAction.deleteNode(node_id, parent_id));\n            nDispatch(nodeStatusAction.setSelect(parent_id));\n        },\n        clearNodeStatus: () => {\n            nDispatch(nodeStatusAction.clearAll());\n        },\n        setMindmap: (mindmap, is_new_map) => {\n            if (is_new_map) {\n                hDispatch(clearHistory());\n                nDispatch(nodeStatusAction.setSelect(mindmap.id));\n            }\n            mDispatch(mindmapAction.setMindmap(mindmap));\n        },\n        expandAll: node_id => {\n            mDispatch(mindmapAction.expandAll(node_id));\n            nDispatch(nodeStatusAction.setSelect(node_id));\n        }\n    }\n};\n\nexport default useMindmap;","export const SET_TITLE = 'global/setTitle';\nexport const SET_THEME = 'global/setTheme';\nexport const ADD_THEME = 'global/addTheme'; /// 主题增删改，将来实现\n\nexport const ZOOM_IN = 'global/zoomIn';\nexport const ZOOM_OUT = 'global/zoomOut';\nexport const ZOOM_RESET= 'global/zoomReset';\n\nexport const MOVE_XY= 'global/moveXY';\nexport const MOVE_RESET= 'global/moveReset';\nexport const MOVE_XY_WHEN_ZOOM= 'global/moveXYWhenZoom';\n"],"sourceRoot":""}