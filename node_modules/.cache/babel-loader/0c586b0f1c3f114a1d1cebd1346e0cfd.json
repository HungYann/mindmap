{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/liuhongyang/Documents/GitHub/repositories/mindmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";function _templateObject2(){var data=_taggedTemplateLiteral([\"\\nmargin: 0;\\npadding: 0;\\nfont-size: 90%;\\nlist-style: circle inside;\\n\\nli {\\nline-height: 2em;\\n}\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\nmargin: 20px 0 5px;\\npadding-bottom: 8px;\\nborder-bottom: 1px solid #dddddd;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useContext}from'react';import{css}from'emotion';import{context}from'../../../context';import{setTitle}from'../../../context/reducer/global/actionCreator';import useMindmap from'../../../customHooks/useMindmap';import{ROOT_NODE_ID}from'../../../statics/refer';import mindmapParser from'../../../methods/mindmapParser';import{ButtonSet,MainButton,Shortcut,Highlight,Annotation}from'../common/styledComponents';var Open=function Open(_ref){var handleClosePopup=_ref.handleClosePopup,handleDownload=_ref.handleDownload;var _useContext=useContext(context),dispatch=_useContext.global.dispatch;var _useMindmap=useMindmap(),setMindmap=_useMindmap.setMindmap;var handleOpenFile=function handleOpenFile(){var input=document.createElement('input');input.type='file';input.accept='.rmf,.km,.txt,.md';input.addEventListener('change',function(event){var file=event.target.files[0],file_name=file.name;var dot_index=file_name.length-1;while(dot_index>0&&file_name[dot_index]!=='.'){dot_index--;}var format=file_name.slice(dot_index+1).toUpperCase(),title=file_name.slice(0,dot_index);var file_reader=new FileReader();file_reader.onload=function(event){var str=event.target.result;var mindmap=mindmapParser(str,format);if(mindmap&&mindmap.id===ROOT_NODE_ID){setMindmap(mindmap,true);dispatch(setTitle(title));handleClosePopup();}else{alert('不是有效的思维导图文件');}};file_reader.readAsText(file);});input.click();};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Highlight,null,\"\\u6253\\u5F00\\u5176\\u4ED6\\u6587\\u4EF6\\u540E\\uFF0C\\u5F53\\u524D\\u601D\\u7EF4\\u5BFC\\u56FE\\u7684\\u6570\\u636E\\u5C06\\u4E22\\u5931\\u3002\"),/*#__PURE__*/React.createElement(Annotation,null,\"\\u8981\\u4FDD\\u5B58\\u5F53\\u524D\\u6570\\u636E\\uFF0C\\u8BF7\\u5C06\\u601D\\u7EF4\\u5BFC\\u56FE\",/*#__PURE__*/React.createElement(Shortcut,{onClick:handleDownload},\"\\u4E0B\\u8F7D\\u81F3\\u672C\\u5730\"),\"\\u3002\"),/*#__PURE__*/React.createElement(\"p\",{className:sub_title},\"\\u652F\\u6301\\u6253\\u5F00\\u683C\\u5F0F\\uFF1A\"),/*#__PURE__*/React.createElement(\"ul\",{className:list_wrapper},/*#__PURE__*/React.createElement(\"li\",null,\"RMind\\uFF08.rmf\\uFF09\"),/*#__PURE__*/React.createElement(\"li\",null,\"\\u767E\\u5EA6\\u8111\\u56FE\\uFF08.km\\uFF09\"),/*#__PURE__*/React.createElement(\"li\",null,\"Markdown\\uFF08.md\\uFF09\"),/*#__PURE__*/React.createElement(\"li\",null,\"\\u6587\\u672C\\u6587\\u4EF6\\uFF08.txt\\uFF09\")),/*#__PURE__*/React.createElement(ButtonSet,null,/*#__PURE__*/React.createElement(MainButton,{onClick:handleOpenFile},\"\\u6253\\u5F00\\u6587\\u4EF6\"),/*#__PURE__*/React.createElement(\"button\",{onClick:handleClosePopup},\"\\u53D6\\u6D88\")));};export default Open;// CSS\nvar sub_title=css(_templateObject());var list_wrapper=css(_templateObject2());","map":{"version":3,"sources":["/Users/liuhongyang/Documents/GitHub/repositories/mindmap/src/components/Popup/subComponents/Open.js"],"names":["React","useContext","css","context","setTitle","useMindmap","ROOT_NODE_ID","mindmapParser","ButtonSet","MainButton","Shortcut","Highlight","Annotation","Open","handleClosePopup","handleDownload","dispatch","global","setMindmap","handleOpenFile","input","document","createElement","type","accept","addEventListener","event","file","target","files","file_name","name","dot_index","length","format","slice","toUpperCase","title","file_reader","FileReader","onload","str","result","mindmap","id","alert","readAsText","click","sub_title","list_wrapper"],"mappings":"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","sourcesContent":["import React, {useContext} from 'react';\nimport {css} from 'emotion';\nimport {context} from '../../../context';\nimport {setTitle} from '../../../context/reducer/global/actionCreator';\nimport useMindmap from '../../../customHooks/useMindmap';\nimport {ROOT_NODE_ID} from '../../../statics/refer';\nimport mindmapParser from '../../../methods/mindmapParser';\nimport {ButtonSet, MainButton, Shortcut, Highlight, Annotation} from '../common/styledComponents';\n\nconst Open = ({handleClosePopup, handleDownload}) => {\n    const {global: {dispatch}} = useContext(context);\n    const {setMindmap} = useMindmap();\n\n    const handleOpenFile = () => {\n        const input = document.createElement('input');\n        input.type = 'file';\n        input.accept = '.rmf,.km,.txt,.md';\n        input.addEventListener('change', event => {\n            const file = event.target.files[0],\n                file_name = file.name;\n            let dot_index = file_name.length - 1;\n            while (dot_index > 0 && file_name[dot_index] !== '.') {\n                dot_index--;\n            }\n            const format = file_name.slice(dot_index + 1).toUpperCase(),\n                title = file_name.slice(0, dot_index);\n            const file_reader = new FileReader();\n            file_reader.onload = event => {\n                const str = event.target.result;\n                const mindmap = mindmapParser(str, format);\n                if (mindmap && mindmap.id === ROOT_NODE_ID) {\n                    setMindmap(mindmap, true);\n                    dispatch(setTitle(title));\n                    handleClosePopup();\n                } else {\n                    alert('不是有效的思维导图文件');\n                }\n            };\n            file_reader.readAsText(file);\n        });\n        input.click();\n    };\n\n    return (<div>\n        <Highlight>打开其他文件后，当前思维导图的数据将丢失。</Highlight>\n        <Annotation>要保存当前数据，请将思维导图<Shortcut onClick={handleDownload}>下载至本地</Shortcut>。</Annotation>\n        <p className={sub_title}>支持打开格式：</p>\n        <ul className={list_wrapper}>\n            <li>RMind（.rmf）</li>\n            <li>百度脑图（.km）</li>\n            <li>Markdown（.md）</li>\n            <li>文本文件（.txt）</li>\n        </ul>\n        <ButtonSet>\n            <MainButton onClick={handleOpenFile}>打开文件</MainButton>\n            <button onClick={handleClosePopup}>取消</button>\n        </ButtonSet>\n    </div>);\n};\n\nexport default Open;\n\n// CSS\nconst sub_title = css`\nmargin: 20px 0 5px;\npadding-bottom: 8px;\nborder-bottom: 1px solid #dddddd;\n`;\n\nconst list_wrapper = css`\nmargin: 0;\npadding: 0;\nfont-size: 90%;\nlist-style: circle inside;\n\nli {\nline-height: 2em;\n}\n`;"]},"metadata":{},"sourceType":"module"}