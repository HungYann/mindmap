{"ast":null,"code":"import * as actionTypes from './actionTypes';\nimport { deepCopy } from '../../../methods/assistFunctions';\nexport const defaultValue_history = {\n  undo: [],\n  redo: [],\n  last_snapshot: null\n};\nexport default ((history, action) => {\n  switch (action.type) {\n    case actionTypes.SET_HISTORY:\n      {\n        const new_history = deepCopy(history);\n\n        if (new_history.last_snapshot) {\n          if (new_history.undo.length > 0 && new_history.undo[new_history.undo.length - 1].mindmap === action.data.mindmap) {\n            new_history.redo.unshift(new_history.last_snapshot);\n            new_history.undo.pop();\n          } else if (new_history.redo.length > 0 && new_history.redo[0].mindmap === action.data.mindmap) {\n            new_history.undo.push(new_history.last_snapshot);\n            new_history.redo.shift();\n          } else {\n            new_history.undo.push(new_history.last_snapshot);\n            new_history.redo = [];\n          }\n        }\n\n        new_history.last_snapshot = action.data;\n        return new_history;\n      }\n\n    case actionTypes.CLEAR_HISTORY:\n      {\n        return defaultValue_history;\n      }\n\n    default:\n      return history;\n  }\n});","map":{"version":3,"sources":["/Users/liuhongyang/Documents/GitHub/repositories/mindmap/src/context/reducer/history/index.js"],"names":["actionTypes","deepCopy","defaultValue_history","undo","redo","last_snapshot","history","action","type","SET_HISTORY","new_history","length","mindmap","data","unshift","pop","push","shift","CLEAR_HISTORY"],"mappings":"AAAA,OAAO,KAAKA,WAAZ,MAA6B,eAA7B;AACA,SAAQC,QAAR,QAAuB,kCAAvB;AAEA,OAAO,MAAMC,oBAAoB,GAAG;AAChCC,EAAAA,IAAI,EAAE,EAD0B;AAEhCC,EAAAA,IAAI,EAAE,EAF0B;AAGhCC,EAAAA,aAAa,EAAE;AAHiB,CAA7B;AAMP,gBAAe,CAACC,OAAD,EAAUC,MAAV,KAAqB;AAChC,UAAQA,MAAM,CAACC,IAAf;AACI,SAAKR,WAAW,CAACS,WAAjB;AAA8B;AAC1B,cAAMC,WAAW,GAAGT,QAAQ,CAACK,OAAD,CAA5B;;AACA,YAAII,WAAW,CAACL,aAAhB,EAA+B;AAC3B,cAAIK,WAAW,CAACP,IAAZ,CAAiBQ,MAAjB,GAA0B,CAA1B,IAA+BD,WAAW,CAACP,IAAZ,CAAiBO,WAAW,CAACP,IAAZ,CAAiBQ,MAAjB,GAA0B,CAA3C,EAA8CC,OAA9C,KAA0DL,MAAM,CAACM,IAAP,CAAYD,OAAzG,EAAkH;AAC9GF,YAAAA,WAAW,CAACN,IAAZ,CAAiBU,OAAjB,CAAyBJ,WAAW,CAACL,aAArC;AACAK,YAAAA,WAAW,CAACP,IAAZ,CAAiBY,GAAjB;AACH,WAHD,MAGO,IAAIL,WAAW,CAACN,IAAZ,CAAiBO,MAAjB,GAA0B,CAA1B,IAA+BD,WAAW,CAACN,IAAZ,CAAiB,CAAjB,EAAoBQ,OAApB,KAAgCL,MAAM,CAACM,IAAP,CAAYD,OAA/E,EAAwF;AAC3FF,YAAAA,WAAW,CAACP,IAAZ,CAAiBa,IAAjB,CAAsBN,WAAW,CAACL,aAAlC;AACAK,YAAAA,WAAW,CAACN,IAAZ,CAAiBa,KAAjB;AACH,WAHM,MAGA;AACHP,YAAAA,WAAW,CAACP,IAAZ,CAAiBa,IAAjB,CAAsBN,WAAW,CAACL,aAAlC;AACAK,YAAAA,WAAW,CAACN,IAAZ,GAAmB,EAAnB;AACH;AACJ;;AACDM,QAAAA,WAAW,CAACL,aAAZ,GAA4BE,MAAM,CAACM,IAAnC;AACA,eAAOH,WAAP;AACH;;AACD,SAAKV,WAAW,CAACkB,aAAjB;AAAgC;AAC5B,eAAOhB,oBAAP;AACH;;AACD;AACI,aAAOI,OAAP;AAtBR;AAwBH,CAzBD","sourcesContent":["import * as actionTypes from './actionTypes';\nimport {deepCopy} from '../../../methods/assistFunctions';\n\nexport const defaultValue_history = {\n    undo: [],\n    redo: [],\n    last_snapshot: null\n};\n\nexport default (history, action) => {\n    switch (action.type) {\n        case actionTypes.SET_HISTORY: {\n            const new_history = deepCopy(history);\n            if (new_history.last_snapshot) {\n                if (new_history.undo.length > 0 && new_history.undo[new_history.undo.length - 1].mindmap === action.data.mindmap) {\n                    new_history.redo.unshift(new_history.last_snapshot);\n                    new_history.undo.pop();\n                } else if (new_history.redo.length > 0 && new_history.redo[0].mindmap === action.data.mindmap) {\n                    new_history.undo.push(new_history.last_snapshot);\n                    new_history.redo.shift();\n                } else {\n                    new_history.undo.push(new_history.last_snapshot);\n                    new_history.redo = [];\n                }\n            }\n            new_history.last_snapshot = action.data;\n            return new_history;\n        }\n        case actionTypes.CLEAR_HISTORY: {\n            return defaultValue_history;\n        }\n        default:\n            return history;\n    }\n};"]},"metadata":{},"sourceType":"module"}