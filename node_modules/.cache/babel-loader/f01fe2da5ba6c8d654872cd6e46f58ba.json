{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/liuhongyang/Documents/GitHub/repositories/mindmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _slicedToArray from\"/Users/liuhongyang/Documents/GitHub/repositories/mindmap/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";function _templateObject2(){var data=_taggedTemplateLiteral([\"\\ndisplay: flex;\\n\"]);_templateObject2=function _templateObject2(){return data;};return data;}function _templateObject(){var data=_taggedTemplateLiteral([\"\\ndisplay: flex;\\njustify-content: space-between;\\nposition: fixed;\\ntop:0;\\nleft:0;\\nright:0;\\nheight: 56px;\\npadding: 0 50px;\\nfont-size: 25px;\\nbackground-color: #ffffff;\\nbox-shadow: 0 0px 2px #aaaaaa;\\nz-index: 10;\\n\"]);_templateObject=function _templateObject(){return data;};return data;}import React,{useState,useContext}from'react';import{css}from'emotion';import{context}from'../../context';import useMindmap from'../../customHooks/useMindmap';import useHistory from'../../customHooks/useHistory';import useZoom from'../../customHooks/useZoom';import useMove from'../../customHooks/useMove';import*as refer from'../../statics/refer';import*as popupType from'../../components/Popup/common/popupType';import{handlePropagation,downloadFile}from'../../methods/assistFunctions';// 防止 Mindmap 中的选中状态由于冒泡被清除\nimport ToolButton from'../../components/ToolButton';import MindmapTitle from'../../components/MindmapTitle';import Popup from'../../components/Popup';var Nav=function Nav(){var _useState=useState(popupType.NONE),_useState2=_slicedToArray(_useState,2),popup=_useState2[0],setPopup=_useState2[1];var _useContext=useContext(context),mindmap=_useContext.mindmap.state,history=_useContext.history.state,title=_useContext.global.state.title;var _useMindmap=useMindmap(),expandAll=_useMindmap.expandAll;var _useZoom=useZoom(),zoomIn=_useZoom.zoomIn,zoomOut=_useZoom.zoomOut,zoomReset=_useZoom.zoomReset;var _useMove=useMove(),moveXY=_useMove.moveXY,moveReset=_useMove.moveReset;var _useHistory=useHistory(),undoHistory=_useHistory.undoHistory,redoHistory=_useHistory.redoHistory;var handleClosePopup=function handleClosePopup(){setPopup(popupType.NONE);};var handleNewFile=function handleNewFile(){setPopup(popupType.NEW);};var handleDownload=function handleDownload(){var url=\"data:text/plain,\".concat(encodeURIComponent(JSON.stringify(mindmap)));downloadFile(url,\"\".concat(title,\".rmf\"));};var handleOpenFile=function handleOpenFile(){setPopup(popupType.OPEN);};var handleExport=function handleExport(){setPopup(popupType.EXPORT);};var handleTheme=function handleTheme(){setPopup(popupType.THEME);};var handleUndo=function handleUndo(){undoHistory();};var handleRedo=function handleRedo(){redoHistory();};var handleExpand=function handleExpand(){expandAll(refer.ROOT_NODE_ID);};var handleZoom=function handleZoom(zoom){console.log('缩放',zoom?zoom:'还原');switch(zoom){case'in':zoomIn();break;case'out':zoomOut();break;default:zoomReset();}};var handleMove=function handleMove(move){console.log('移动',move?move:'还原');switch(move){case'up':moveXY(0,-5);break;case'down':moveXY(0,5);break;case'left':moveXY(-5,0);break;case'right':moveXY(5,0);break;default:moveReset();}};return/*#__PURE__*/React.createElement(\"nav\",{className:wrapper},/*#__PURE__*/React.createElement(\"section\",{className:section,onClick:handlePropagation},/*#__PURE__*/React.createElement(ToolButton,{icon:'add-item-alt',onClick:handleNewFile},\"\\u65B0\\u5EFA\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'folder-open',onClick:handleOpenFile},\"\\u6253\\u5F00\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'file-download',onClick:handleDownload},\"\\u4E0B\\u8F7D\\u81F3\\u672C\\u5730\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'duplicate',onClick:handleExport},\"\\u5BFC\\u51FA\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'palette',onClick:handleTheme},\"\\u4E3B\\u9898\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'plus-circle',onClick:function onClick(){return handleZoom('in');}},\"\\u653E\\u5927\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'minus-circle',onClick:function onClick(){return handleZoom('out');}},\"\\u7F29\\u5C0F\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'rotate-left',onClick:function onClick(){return handleZoom();}},\"\\u8FD8\\u539F\")),/*#__PURE__*/React.createElement(\"section\",{className:section},/*#__PURE__*/React.createElement(MindmapTitle,null)),/*#__PURE__*/React.createElement(\"section\",{className:section,onClick:handlePropagation},/*#__PURE__*/React.createElement(ToolButton,{icon:'rotate-left',onClick:function onClick(){return handleMove();}},\"\\u8FD8\\u539F\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'arrow-left',onClick:function onClick(){return handleMove('left');}},\"\\u5DE6\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'arrow-up',onClick:function onClick(){return handleMove('up');}},\"\\u4E0A\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'arrow-down',onClick:function onClick(){return handleMove('down');}},\"\\u4E0B\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'arrow-right',onClick:function onClick(){return handleMove('right');}},\"\\u53F3\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'undo',disabled:history.undo.length===0,onClick:handleUndo},\"\\u64A4\\u9500\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'redo',disabled:history.redo.length===0,onClick:handleRedo},\"\\u91CD\\u505A\"),/*#__PURE__*/React.createElement(ToolButton,{icon:'scale',onClick:handleExpand},\"\\u5C55\\u5F00\\u6240\\u6709\\u8282\\u70B9\")),popup!==popupType.NONE&&/*#__PURE__*/React.createElement(Popup,{type:popup,handleClosePopup:handleClosePopup,handleDownload:handleDownload}));};export default Nav;// CSS\nvar wrapper=css(_templateObject());var section=css(_templateObject2());","map":{"version":3,"sources":["/Users/liuhongyang/Documents/GitHub/repositories/mindmap/src/features/Nav/index.js"],"names":["React","useState","useContext","css","context","useMindmap","useHistory","useZoom","useMove","refer","popupType","handlePropagation","downloadFile","ToolButton","MindmapTitle","Popup","Nav","NONE","popup","setPopup","mindmap","state","history","title","global","expandAll","zoomIn","zoomOut","zoomReset","moveXY","moveReset","undoHistory","redoHistory","handleClosePopup","handleNewFile","NEW","handleDownload","url","encodeURIComponent","JSON","stringify","handleOpenFile","OPEN","handleExport","EXPORT","handleTheme","THEME","handleUndo","handleRedo","handleExpand","ROOT_NODE_ID","handleZoom","zoom","console","log","handleMove","move","wrapper","section","undo","length","redo"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react';\nimport { css } from 'emotion';\nimport { context } from '../../context';\nimport useMindmap from '../../customHooks/useMindmap';\nimport useHistory from '../../customHooks/useHistory';\nimport useZoom from '../../customHooks/useZoom';\nimport useMove from '../../customHooks/useMove';\nimport * as refer from '../../statics/refer';\nimport * as popupType from '../../components/Popup/common/popupType';\nimport { handlePropagation, downloadFile } from '../../methods/assistFunctions'; // 防止 Mindmap 中的选中状态由于冒泡被清除\nimport ToolButton from '../../components/ToolButton';\nimport MindmapTitle from '../../components/MindmapTitle';\nimport Popup from '../../components/Popup';\n\nconst Nav = () => {\n    const [popup, setPopup] = useState(popupType.NONE);\n    const { mindmap: { state: mindmap }, history: { state: history }, global: { state: { title } } } = useContext(context);\n    const { expandAll } = useMindmap();\n    const { zoomIn, zoomOut, zoomReset } = useZoom();\n    const { moveXY, moveReset } = useMove()\n    const { undoHistory, redoHistory } = useHistory();\n\n    const handleClosePopup = () => {\n        setPopup(popupType.NONE);\n    };\n\n    const handleNewFile = () => {\n        setPopup(popupType.NEW);\n    };\n\n    const handleDownload = () => {\n        const url = `data:text/plain,${encodeURIComponent(JSON.stringify(mindmap))}`;\n        downloadFile(url, `${title}.rmf`);\n    };\n\n    const handleOpenFile = () => {\n        setPopup(popupType.OPEN);\n    };\n\n    const handleExport = () => {\n        setPopup(popupType.EXPORT);\n    };\n\n    const handleTheme = () => {\n        setPopup(popupType.THEME);\n    };\n\n    const handleUndo = () => {\n        undoHistory();\n    };\n\n    const handleRedo = () => {\n        redoHistory();\n    };\n\n    const handleExpand = () => {\n        expandAll(refer.ROOT_NODE_ID);\n    };\n\n    const handleZoom = (zoom) => {\n        console.log('缩放', zoom ? zoom : '还原')\n        switch (zoom) {\n            case 'in':\n                zoomIn()\n                break;\n            case 'out':\n                zoomOut()\n                break;\n            default:\n                zoomReset()\n        }\n    }\n\n    const handleMove = (move) => {\n        console.log('移动', move ? move : '还原')\n        switch (move) {\n            case 'up':\n                moveXY(0,-5)\n                break;\n            case 'down':\n                moveXY(0,5)\n                break;\n            case 'left':\n                moveXY(-5,0)\n                break;\n            case 'right':\n                moveXY(5,0)\n                break;\n            default:\n                moveReset()\n        }\n    }\n\n    return (<nav className={wrapper}>\n        <section className={section} onClick={handlePropagation}>\n            <ToolButton icon={'add-item-alt'} onClick={handleNewFile}>新建</ToolButton>\n            <ToolButton icon={'folder-open'} onClick={handleOpenFile}>打开</ToolButton>\n            <ToolButton icon={'file-download'} onClick={handleDownload}>下载至本地</ToolButton>\n            <ToolButton icon={'duplicate'} onClick={handleExport}>导出</ToolButton>\n            <ToolButton icon={'palette'} onClick={handleTheme}>主题</ToolButton>\n            <ToolButton icon={'plus-circle'} onClick={() => handleZoom('in')}>放大</ToolButton>\n            <ToolButton icon={'minus-circle'} onClick={() => handleZoom('out')}>缩小</ToolButton>\n            <ToolButton icon={'rotate-left'} onClick={() => handleZoom()}>还原</ToolButton>\n        </section>\n        <section className={section}>\n            <MindmapTitle />\n        </section>\n        <section className={section} onClick={handlePropagation}>\n            <ToolButton icon={'rotate-left'} onClick={() => handleMove()}>还原</ToolButton>\n            <ToolButton icon={'arrow-left'} onClick={() => handleMove('left')}>左</ToolButton>\n            <ToolButton icon={'arrow-up'} onClick={() => handleMove('up')}>上</ToolButton>\n            <ToolButton icon={'arrow-down'} onClick={() => handleMove('down')}>下</ToolButton>\n            <ToolButton icon={'arrow-right'} onClick={() => handleMove('right')}>右</ToolButton>\n            <ToolButton icon={'undo'} disabled={history.undo.length === 0} onClick={handleUndo}>撤销</ToolButton>\n            <ToolButton icon={'redo'} disabled={history.redo.length === 0} onClick={handleRedo}>重做</ToolButton>\n            <ToolButton icon={'scale'} onClick={handleExpand}>展开所有节点</ToolButton>\n        </section>\n        {popup !== popupType.NONE &&\n            <Popup type={popup} handleClosePopup={handleClosePopup} handleDownload={handleDownload} />}\n    </nav>);\n};\n\nexport default Nav;\n\n// CSS\nconst wrapper = css`\ndisplay: flex;\njustify-content: space-between;\nposition: fixed;\ntop:0;\nleft:0;\nright:0;\nheight: 56px;\npadding: 0 50px;\nfont-size: 25px;\nbackground-color: #ffffff;\nbox-shadow: 0 0px 2px #aaaaaa;\nz-index: 10;\n`;\n\nconst section = css`\ndisplay: flex;\n`;"]},"metadata":{},"sourceType":"module"}